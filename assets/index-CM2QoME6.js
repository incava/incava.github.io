(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=e(i);fetch(i.href,l)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class te{}function _(o,t){const e=/\{([^}]+)\}/g;return o.replace(e,(n,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const l=t[i];return l!=null?String(l):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function s(o,t,e){for(let l=0;l<t.length-1;l++){const a=t[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in o))if(Array.isArray(e))o[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(o[u])){const c=o[u];if(Array.isArray(e))for(let d=0;d<c.length;d++){const p=c[d];s(p,t.slice(l+1),e[d])}else for(const d of c)s(d,t.slice(l+1),e)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in o||(o[u]=[{}]);const c=o[u];s(c[0],t.slice(l+1),e);return}(!o[a]||typeof o[a]!="object")&&(o[a]={}),o=o[a]}const n=t[t.length-1],i=o[n];if(i!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===i)return;if(typeof i=="object"&&typeof e=="object"&&i!==null&&e!==null)Object.assign(i,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else o[n]=e}function r(o,t){try{if(t.length===1&&t[0]==="_self")return o;for(let e=0;e<t.length;e++){if(typeof o!="object"||o===null)return;const n=t[e];if(n.endsWith("[]")){const i=n.slice(0,-2);if(i in o){const l=o[i];return Array.isArray(l)?l.map(a=>r(a,t.slice(e+1))):void 0}else return}else o=o[n]}return o}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R(o,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(o.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function je(o,t){const e=R(o,t);return e?e.startsWith("publishers/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}`:e.startsWith("models/")&&o.isVertexAI()?`projects/${o.getProject()}/locations/${o.getLocation()}/publishers/google/${e}`:e:""}function ce(o,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function $(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>ce(o,e)):[ce(o,t)]}function et(o){return o!=null&&typeof o=="object"&&"parts"in o&&Array.isArray(o.parts)}function yt(o){return o!=null&&typeof o=="object"&&"functionCall"in o}function le(o){return!(o==null||yt(o))}function tt(o){return o==null||Array.isArray(o)&&o.length===0?!1:o.every(le)}function b(o,t){if(t==null)throw new Error("ContentUnion is required");return et(t)?t:le(t)?{role:"user",parts:$(o,t)}:{role:"model",parts:$(o,t)}}function nt(o,t){if(!t)return[];if(o.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=b(o,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(o.isVertexAI()){const e=b(o,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>b(o,e)):[b(o,t)]}function J(o,t,e){e.length!==0&&(tt(e)?t.push({role:"user",parts:$(o,e)}):t.push({role:"model",parts:$(o,e)}),e.length=0)}function vt(o,t,e,n){le(n)===tt(e)||(J(o,t,e),e.length=0),e.push(n)}function A(o,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t))return[b(o,t)];const e=[],n=[];for(const i of t)if(et(i))J(o,e,n),e.push(i);else if(typeof i=="string"||typeof i=="object"&&!Array.isArray(i))vt(o,e,n,i);else if(Array.isArray(i))J(o,e,n),e.push({role:"user",parts:$(o,i)});else throw new Error(`Unsupported content type: ${typeof i}`);return J(o,e,n),e}function W(o,t){if(!o.isVertexAI()&&"default"in t)throw new Error("Default value is not supported in the response schema for the Gemini API.");if("anyOf"in t&&t.anyOf!==void 0)for(const e of t.anyOf)W(o,e);if("items"in t&&t.items!==void 0&&W(o,t.items),"properties"in t&&t.properties!==void 0)for(const e of Object.values(t.properties))W(o,e)}function ot(o,t){return W(o,t),t}function it(o,t){if(typeof t=="object"&&"voiceConfig"in t)return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function st(o,t){return t}function U(o,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function Ct(o,t,e,n=1){const i=!t.startsWith(`${e}/`)&&t.split("/").length===n;return o.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${o.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${o.getProject()}/locations/${o.getLocation()}/${t}`:i?`projects/${o.getProject()}/locations/${o.getLocation()}/${e}/${t}`:t:i?`${e}/${t}`:t}function V(o,t){if(typeof t!="string")throw new Error("name must be a string");return Ct(o,t,"cachedContents")}function F(o,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function rt(o,t){if(typeof t!="string")throw new Error("fromName must be a string");return t.startsWith("files/")?t.split("files/")[1]:t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Et(o,t){const e={};if(r(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=r(t,["thought"]);n!=null&&s(e,["thought"],n);const i=r(t,["codeExecutionResult"]);i!=null&&s(e,["codeExecutionResult"],i);const l=r(t,["executableCode"]);l!=null&&s(e,["executableCode"],l);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],a);const u=r(t,["functionCall"]);u!=null&&s(e,["functionCall"],u);const c=r(t,["functionResponse"]);c!=null&&s(e,["functionResponse"],c);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],d);const p=r(t,["text"]);return p!=null&&s(e,["text"],p),e}function de(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>Et(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function Tt(o,t){const e={};if(r(t,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=r(t,["description"]);n!=null&&s(e,["description"],n);const i=r(t,["name"]);i!=null&&s(e,["name"],i);const l=r(t,["parameters"]);return l!=null&&s(e,["parameters"],l),e}function It(){return{}}function _t(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["dynamicThreshold"]);return i!=null&&s(e,["dynamicThreshold"],i),e}function wt(o,t){const e={},n=r(t,["dynamicRetrievalConfig"]);return n!=null&&s(e,["dynamicRetrievalConfig"],_t(o,n)),e}function At(o,t){const e={},n=r(t,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?s(e,["functionDeclarations"],n.map(u=>Tt(o,u))):s(e,["functionDeclarations"],n)),r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");r(t,["googleSearch"])!=null&&s(e,["googleSearch"],It());const l=r(t,["googleSearchRetrieval"]);l!=null&&s(e,["googleSearchRetrieval"],wt(o,l));const a=r(t,["codeExecution"]);return a!=null&&s(e,["codeExecution"],a),e}function xt(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["allowedFunctionNames"]);return i!=null&&s(e,["allowedFunctionNames"],i),e}function Mt(o,t){const e={},n=r(t,["functionCallingConfig"]);return n!=null&&s(e,["functionCallingConfig"],xt(o,n)),e}function St(o,t,e){const n={},i=r(t,["ttl"]);e!==void 0&&i!=null&&s(e,["ttl"],i);const l=r(t,["expireTime"]);e!==void 0&&l!=null&&s(e,["expireTime"],l);const a=r(t,["displayName"]);e!==void 0&&a!=null&&s(e,["displayName"],a);const u=r(t,["contents"]);e!==void 0&&u!=null&&(Array.isArray(u)?s(e,["contents"],A(o,A(o,u).map(f=>de(o,f)))):s(e,["contents"],A(o,u)));const c=r(t,["systemInstruction"]);e!==void 0&&c!=null&&s(e,["systemInstruction"],de(o,b(o,c)));const d=r(t,["tools"]);e!==void 0&&d!=null&&(Array.isArray(d)?s(e,["tools"],d.map(f=>At(o,f))):s(e,["tools"],d));const p=r(t,["toolConfig"]);return e!==void 0&&p!=null&&s(e,["toolConfig"],Mt(o,p)),n}function Pt(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["model"],je(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],St(o,i,e)),e}function Rt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function bt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Nt(o,t,e){const n={},i=r(t,["ttl"]);e!==void 0&&i!=null&&s(e,["ttl"],i);const l=r(t,["expireTime"]);return e!==void 0&&l!=null&&s(e,["expireTime"],l),n}function Dt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],Nt(o,i,e)),e}function Lt(o,t,e){const n={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&s(e,["_query","pageSize"],i);const l=r(t,["pageToken"]);return e!==void 0&&l!=null&&s(e,["_query","pageToken"],l),n}function Vt(o,t){const e={},n=r(t,["config"]);return n!=null&&s(e,["config"],Lt(o,n,e)),e}function Ft(o,t){const e={},n=r(t,["videoMetadata"]);n!=null&&s(e,["videoMetadata"],n);const i=r(t,["thought"]);i!=null&&s(e,["thought"],i);const l=r(t,["codeExecutionResult"]);l!=null&&s(e,["codeExecutionResult"],l);const a=r(t,["executableCode"]);a!=null&&s(e,["executableCode"],a);const u=r(t,["fileData"]);u!=null&&s(e,["fileData"],u);const c=r(t,["functionCall"]);c!=null&&s(e,["functionCall"],c);const d=r(t,["functionResponse"]);d!=null&&s(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&s(e,["inlineData"],p);const f=r(t,["text"]);return f!=null&&s(e,["text"],f),e}function pe(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>Ft(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function kt(o,t){const e={},n=r(t,["example"]);n!=null&&s(e,["example"],n);const i=r(t,["pattern"]);i!=null&&s(e,["pattern"],i);const l=r(t,["default"]);l!=null&&s(e,["default"],l);const a=r(t,["maxLength"]);a!=null&&s(e,["maxLength"],a);const u=r(t,["minLength"]);u!=null&&s(e,["minLength"],u);const c=r(t,["minProperties"]);c!=null&&s(e,["minProperties"],c);const d=r(t,["maxProperties"]);d!=null&&s(e,["maxProperties"],d);const p=r(t,["anyOf"]);p!=null&&s(e,["anyOf"],p);const f=r(t,["description"]);f!=null&&s(e,["description"],f);const y=r(t,["enum"]);y!=null&&s(e,["enum"],y);const g=r(t,["format"]);g!=null&&s(e,["format"],g);const m=r(t,["items"]);m!=null&&s(e,["items"],m);const h=r(t,["maxItems"]);h!=null&&s(e,["maxItems"],h);const E=r(t,["maximum"]);E!=null&&s(e,["maximum"],E);const C=r(t,["minItems"]);C!=null&&s(e,["minItems"],C);const v=r(t,["minimum"]);v!=null&&s(e,["minimum"],v);const T=r(t,["nullable"]);T!=null&&s(e,["nullable"],T);const I=r(t,["properties"]);I!=null&&s(e,["properties"],I);const w=r(t,["propertyOrdering"]);w!=null&&s(e,["propertyOrdering"],w);const x=r(t,["required"]);x!=null&&s(e,["required"],x);const M=r(t,["title"]);M!=null&&s(e,["title"],M);const S=r(t,["type"]);return S!=null&&s(e,["type"],S),e}function Ut(o,t){const e={},n=r(t,["response"]);n!=null&&s(e,["response"],kt(o,n));const i=r(t,["description"]);i!=null&&s(e,["description"],i);const l=r(t,["name"]);l!=null&&s(e,["name"],l);const a=r(t,["parameters"]);return a!=null&&s(e,["parameters"],a),e}function Bt(){return{}}function qt(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["dynamicThreshold"]);return i!=null&&s(e,["dynamicThreshold"],i),e}function Gt(o,t){const e={},n=r(t,["dynamicRetrievalConfig"]);return n!=null&&s(e,["dynamicRetrievalConfig"],qt(o,n)),e}function Ht(o,t){const e={},n=r(t,["functionDeclarations"]);n!=null&&(Array.isArray(n)?s(e,["functionDeclarations"],n.map(c=>Ut(o,c))):s(e,["functionDeclarations"],n));const i=r(t,["retrieval"]);i!=null&&s(e,["retrieval"],i),r(t,["googleSearch"])!=null&&s(e,["googleSearch"],Bt());const a=r(t,["googleSearchRetrieval"]);a!=null&&s(e,["googleSearchRetrieval"],Gt(o,a));const u=r(t,["codeExecution"]);return u!=null&&s(e,["codeExecution"],u),e}function $t(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["allowedFunctionNames"]);return i!=null&&s(e,["allowedFunctionNames"],i),e}function Ot(o,t){const e={},n=r(t,["functionCallingConfig"]);return n!=null&&s(e,["functionCallingConfig"],$t(o,n)),e}function zt(o,t,e){const n={},i=r(t,["ttl"]);e!==void 0&&i!=null&&s(e,["ttl"],i);const l=r(t,["expireTime"]);e!==void 0&&l!=null&&s(e,["expireTime"],l);const a=r(t,["displayName"]);e!==void 0&&a!=null&&s(e,["displayName"],a);const u=r(t,["contents"]);e!==void 0&&u!=null&&(Array.isArray(u)?s(e,["contents"],A(o,A(o,u).map(f=>pe(o,f)))):s(e,["contents"],A(o,u)));const c=r(t,["systemInstruction"]);e!==void 0&&c!=null&&s(e,["systemInstruction"],pe(o,b(o,c)));const d=r(t,["tools"]);e!==void 0&&d!=null&&(Array.isArray(d)?s(e,["tools"],d.map(f=>Ht(o,f))):s(e,["tools"],d));const p=r(t,["toolConfig"]);return e!==void 0&&p!=null&&s(e,["toolConfig"],Ot(o,p)),n}function Yt(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["model"],je(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],zt(o,i,e)),e}function Kt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Jt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Wt(o,t,e){const n={},i=r(t,["ttl"]);e!==void 0&&i!=null&&s(e,["ttl"],i);const l=r(t,["expireTime"]);return e!==void 0&&l!=null&&s(e,["expireTime"],l),n}function Xt(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","name"],V(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],Wt(o,i,e)),e}function Qt(o,t,e){const n={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&s(e,["_query","pageSize"],i);const l=r(t,["pageToken"]);return e!==void 0&&l!=null&&s(e,["_query","pageToken"],l),n}function Zt(o,t){const e={},n=r(t,["config"]);return n!=null&&s(e,["config"],Qt(o,n,e)),e}function X(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["displayName"]);i!=null&&s(e,["displayName"],i);const l=r(t,["model"]);l!=null&&s(e,["model"],l);const a=r(t,["createTime"]);a!=null&&s(e,["createTime"],a);const u=r(t,["updateTime"]);u!=null&&s(e,["updateTime"],u);const c=r(t,["expireTime"]);c!=null&&s(e,["expireTime"],c);const d=r(t,["usageMetadata"]);return d!=null&&s(e,["usageMetadata"],d),e}function jt(){return{}}function en(o,t){const e={},n=r(t,["nextPageToken"]);n!=null&&s(e,["nextPageToken"],n);const i=r(t,["cachedContents"]);return i!=null&&(Array.isArray(i)?s(e,["cachedContents"],i.map(l=>X(o,l))):s(e,["cachedContents"],i)),e}function Q(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["displayName"]);i!=null&&s(e,["displayName"],i);const l=r(t,["model"]);l!=null&&s(e,["model"],l);const a=r(t,["createTime"]);a!=null&&s(e,["createTime"],a);const u=r(t,["updateTime"]);u!=null&&s(e,["updateTime"],u);const c=r(t,["expireTime"]);c!=null&&s(e,["expireTime"],c);const d=r(t,["usageMetadata"]);return d!=null&&s(e,["usageMetadata"],d),e}function tn(){return{}}function nn(o,t){const e={},n=r(t,["nextPageToken"]);n!=null&&s(e,["nextPageToken"],n);const i=r(t,["cachedContents"]);return i!=null&&(Array.isArray(i)?s(e,["cachedContents"],i.map(l=>Q(o,l))):s(e,["cachedContents"],i)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Z;(function(o){o.PAGED_ITEM_BATCH_JOBS="batchJobs",o.PAGED_ITEM_MODELS="models",o.PAGED_ITEM_TUNING_JOBS="tuningJobs",o.PAGED_ITEM_FILES="files",o.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Z||(Z={}));class lt{constructor(t,e,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,i)}init(t,e,n){var i,l;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};n?typeof n=="object"?a=Object.assign({},n):a=n:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var fe;(function(o){o.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",o.OUTCOME_OK="OUTCOME_OK",o.OUTCOME_FAILED="OUTCOME_FAILED",o.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(fe||(fe={}));var me;(function(o){o.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",o.PYTHON="PYTHON"})(me||(me={}));var he;(function(o){o.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",o.STRING="STRING",o.NUMBER="NUMBER",o.INTEGER="INTEGER",o.BOOLEAN="BOOLEAN",o.ARRAY="ARRAY",o.OBJECT="OBJECT"})(he||(he={}));var ge;(function(o){o.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",o.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",o.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",o.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",o.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",o.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ge||(ge={}));var ye;(function(o){o.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",o.SEVERITY="SEVERITY",o.PROBABILITY="PROBABILITY"})(ye||(ye={}));var ve;(function(o){o.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE",o.OFF="OFF"})(ve||(ve={}));var Ce;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ce||(Ce={}));var Ee;(function(o){o.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",o.STOP="STOP",o.MAX_TOKENS="MAX_TOKENS",o.SAFETY="SAFETY",o.RECITATION="RECITATION",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT",o.SPII="SPII",o.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",o.IMAGE_SAFETY="IMAGE_SAFETY"})(Ee||(Ee={}));var Te;(function(o){o.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",o.NEGLIGIBLE="NEGLIGIBLE",o.LOW="LOW",o.MEDIUM="MEDIUM",o.HIGH="HIGH"})(Te||(Te={}));var Ie;(function(o){o.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",o.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",o.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",o.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",o.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ie||(Ie={}));var _e;(function(o){o.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",o.SAFETY="SAFETY",o.OTHER="OTHER",o.BLOCKLIST="BLOCKLIST",o.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(_e||(_e={}));var j;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.AUDIO="AUDIO"})(j||(j={}));var we;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.ACTIVE="ACTIVE",o.ERROR="ERROR"})(we||(we={}));var Ae;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.MODE_DYNAMIC="MODE_DYNAMIC"})(Ae||(Ae={}));var xe;(function(o){o.MODE_UNSPECIFIED="MODE_UNSPECIFIED",o.AUTO="AUTO",o.ANY="ANY",o.NONE="NONE"})(xe||(xe={}));var Me;(function(o){o.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",o.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",o.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",o.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Me||(Me={}));var Se;(function(o){o.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",o.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",o.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",o.BLOCK_NONE="BLOCK_NONE"})(Se||(Se={}));var Pe;(function(o){o.DONT_ALLOW="DONT_ALLOW",o.ALLOW_ADULT="ALLOW_ADULT",o.ALLOW_ALL="ALLOW_ALL"})(Pe||(Pe={}));var Re;(function(o){o.auto="auto",o.en="en",o.ja="ja",o.ko="ko",o.hi="hi"})(Re||(Re={}));var be;(function(o){o.STATE_UNSPECIFIED="STATE_UNSPECIFIED",o.PROCESSING="PROCESSING",o.ACTIVE="ACTIVE",o.FAILED="FAILED"})(be||(be={}));var Ne;(function(o){o.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",o.UPLOADED="UPLOADED",o.GENERATED="GENERATED"})(Ne||(Ne={}));var De;(function(o){o.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",o.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",o.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",o.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",o.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(De||(De={}));var Le;(function(o){o.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",o.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",o.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",o.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Le||(Le={}));var Ve;(function(o){o.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",o.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",o.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",o.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ve||(Ve={}));var Fe;(function(o){o.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",o.TEXT="TEXT",o.IMAGE="IMAGE",o.VIDEO="VIDEO",o.AUDIO="AUDIO",o.DOCUMENT="DOCUMENT"})(Fe||(Fe={}));class K{get text(){var t,e,n,i,l,a,u,c;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",p=!1;const f=[];for(const y of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[g,m]of Object.entries(y))g!=="text"&&g!=="thought"&&(m!==null||m!==void 0)&&f.push(g);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;p=!0,d+=y.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),p?d:void 0}get functionCalls(){var t,e,n,i,l,a,u,c;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.functionCall).map(p=>p.functionCall).filter(p=>p!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var t,e,n,i,l,a,u,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const p=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if((p==null?void 0:p.length)!==0)return(d=p==null?void 0:p[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var t,e,n,i,l,a,u,c,d;if(((i=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const p=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if((p==null?void 0:p.length)!==0)return(d=p==null?void 0:p[0])===null||d===void 0?void 0:d.output}}class ke{}class Ue{}class Be{}class on{}class qe{}class Ge{}class sn{}class at{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class rn{}class ln{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class an extends te{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new lt(Z.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Yt(this.apiClient,t);return l=_("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Q(this.apiClient,c))}else{const u=Pt(this.apiClient,t);return l=_("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>X(this.apiClient,c))}}async get(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Kt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Q(this.apiClient,c))}else{const u=Rt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>X(this.apiClient,c))}}async delete(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Jt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(()=>{const c=tn(),d=new qe;return Object.assign(d,c),d})}else{const u=bt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(()=>{const c=jt(),d=new qe;return Object.assign(d,c),d})}}async update(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Xt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Q(this.apiClient,c))}else{const u=Dt(this.apiClient,t);return l=_("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>X(this.apiClient,c))}}async listInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Zt(this.apiClient,t);return l=_("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const d=nn(this.apiClient,c),p=new Ge;return Object.assign(p,d),p})}else{const u=Vt(this.apiClient,t);return l=_("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=en(this.apiClient,c),p=new Ge;return Object.assign(p,d),p})}}}function He(o){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&o[t],n=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function P(o){return this instanceof P?(this.v=o,this):new P(o)}function ee(o,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(o,t||[]),i,l=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(g){return function(m){return Promise.resolve(m).then(g,f)}}function u(g,m){n[g]&&(i[g]=function(h){return new Promise(function(E,C){l.push([g,h,E,C])>1||c(g,h)})},m&&(i[g]=m(i[g])))}function c(g,m){try{d(n[g](m))}catch(h){y(l[0][3],h)}}function d(g){g.value instanceof P?Promise.resolve(g.value.v).then(p,f):y(l[0][2],g)}function p(g){c("next",g)}function f(g){c("throw",g)}function y(g,m){g(m),l.shift(),l.length&&c(l[0][0],l[0][1])}}function ie(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],e;return t?t.call(o):(o=typeof He=="function"?He(o):o[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=o[l]&&function(a){return new Promise(function(u,c){a=o[l](a),i(u,c,a.done,a.value)})}}function i(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function un(o){var t;if(o.candidates==null||o.candidates.length===0)return!1;const e=(t=o.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:ut(e)}function ut(o){if(o.parts===void 0||o.parts.length===0)return!1;for(const t of o.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function cn(o){if(o.length!==0){if(o[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of o)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function dn(o){if(o===void 0||o.length===0)return[];const t=[],e=o.length;let n=0,i=o[0];for(;n<e;)if(o[n].role==="user")i=o[n],n++;else{const l=[];let a=!0;for(;n<e&&o[n].role==="model";)l.push(o[n]),a&&!ut(o[n])&&(a=!1),n++;a&&(t.push(i),t.push(...l))}return t}class pn{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new fn(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class fn{constructor(t,e,n,i={},l=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=i,this.history=l,this.sendPromise=Promise.resolve(),cn(l)}async sendMessage(t){var e;await this.sendPromise;const n=b(this.apiClient,t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const c=(a=(l=(await i).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,d=c?[c]:[];this.recordHistory(n,d)})(),await this.sendPromise,i}async sendMessageStream(t){var e;await this.sendPromise;const n=b(this.apiClient,t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=i.then(()=>{});const l=await i;return this.processStreamResponse(l,n)}getHistory(t=!1){return t?dn(this.history):this.history}processStreamResponse(t,e){var n,i;return ee(this,arguments,function*(){var a,u,c,d;const p=[];try{for(var f=!0,y=ie(t),g;g=yield P(y.next()),a=g.done,!a;f=!0){d=g.value,f=!1;const m=d;if(un(m)){const h=(i=(n=m.candidates)===null||n===void 0?void 0:n[0])===null||i===void 0?void 0:i.content;h!==void 0&&p.push(h)}yield yield P(m)}}catch(m){u={error:m}}finally{try{!f&&!a&&(c=y.return)&&(yield P(c.call(y)))}finally{if(u)throw u.error}}this.recordHistory(e,p)})}recordHistory(t,e){let n=[];e.length>0&&e.every(i=>i.role==="model")?n=e:n.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mn(o,t,e){const n={},i=r(t,["pageSize"]);e!==void 0&&i!=null&&s(e,["_query","pageSize"],i);const l=r(t,["pageToken"]);return e!==void 0&&l!=null&&s(e,["_query","pageToken"],l),n}function hn(o,t){const e={},n=r(t,["config"]);return n!=null&&s(e,["config"],mn(o,n,e)),e}function gn(o,t){const e={},n=r(t,["details"]);n!=null&&s(e,["details"],n);const i=r(t,["message"]);i!=null&&s(e,["message"],i);const l=r(t,["code"]);return l!=null&&s(e,["code"],l),e}function yn(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["displayName"]);i!=null&&s(e,["displayName"],i);const l=r(t,["mimeType"]);l!=null&&s(e,["mimeType"],l);const a=r(t,["sizeBytes"]);a!=null&&s(e,["sizeBytes"],a);const u=r(t,["createTime"]);u!=null&&s(e,["createTime"],u);const c=r(t,["expirationTime"]);c!=null&&s(e,["expirationTime"],c);const d=r(t,["updateTime"]);d!=null&&s(e,["updateTime"],d);const p=r(t,["sha256Hash"]);p!=null&&s(e,["sha256Hash"],p);const f=r(t,["uri"]);f!=null&&s(e,["uri"],f);const y=r(t,["downloadUri"]);y!=null&&s(e,["downloadUri"],y);const g=r(t,["state"]);g!=null&&s(e,["state"],g);const m=r(t,["source"]);m!=null&&s(e,["source"],m);const h=r(t,["videoMetadata"]);h!=null&&s(e,["videoMetadata"],h);const E=r(t,["error"]);return E!=null&&s(e,["error"],gn(o,E)),e}function vn(o,t){const e={},n=r(t,["file"]);n!=null&&s(e,["file"],yn(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Cn(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","file"],rt(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function En(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["_url","file"],rt(o,n));const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Tn(o,t){const e={},n=r(t,["details"]);n!=null&&s(e,["details"],n);const i=r(t,["message"]);i!=null&&s(e,["message"],i);const l=r(t,["code"]);return l!=null&&s(e,["code"],l),e}function se(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["displayName"]);i!=null&&s(e,["displayName"],i);const l=r(t,["mimeType"]);l!=null&&s(e,["mimeType"],l);const a=r(t,["sizeBytes"]);a!=null&&s(e,["sizeBytes"],a);const u=r(t,["createTime"]);u!=null&&s(e,["createTime"],u);const c=r(t,["expirationTime"]);c!=null&&s(e,["expirationTime"],c);const d=r(t,["updateTime"]);d!=null&&s(e,["updateTime"],d);const p=r(t,["sha256Hash"]);p!=null&&s(e,["sha256Hash"],p);const f=r(t,["uri"]);f!=null&&s(e,["uri"],f);const y=r(t,["downloadUri"]);y!=null&&s(e,["downloadUri"],y);const g=r(t,["state"]);g!=null&&s(e,["state"],g);const m=r(t,["source"]);m!=null&&s(e,["source"],m);const h=r(t,["videoMetadata"]);h!=null&&s(e,["videoMetadata"],h);const E=r(t,["error"]);return E!=null&&s(e,["error"],Tn(o,E)),e}function In(o,t){const e={},n=r(t,["nextPageToken"]);n!=null&&s(e,["nextPageToken"],n);const i=r(t,["files"]);return i!=null&&(Array.isArray(i)?s(e,["files"],i.map(l=>se(o,l))):s(e,["files"],i)),e}function _n(o,t){const e={},n=r(t,["httpHeaders"]);return n!=null&&s(e,["httpHeaders"],n),e}function wn(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class An extends te{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new lt(Z.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>se(this.apiClient,e))}async listInternal(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=hn(this.apiClient,t);return i=_("files",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>{const c=In(this.apiClient,u),d=new sn;return Object.assign(d,c),d})}}async createInternal(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=vn(this.apiClient,t);return i=_("upload/v1beta/files",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>{const c=_n(this.apiClient,u),d=new rn;return Object.assign(d,c),d})}}async get(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Cn(this.apiClient,t);return i=_("files/{file}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>se(this.apiClient,u))}}async delete(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=En(this.apiClient,t);return i=_("files/{file}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(()=>{const u=wn(),c=new ln;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xn(o,t){const e={};if(r(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=r(t,["thought"]);n!=null&&s(e,["thought"],n);const i=r(t,["codeExecutionResult"]);i!=null&&s(e,["codeExecutionResult"],i);const l=r(t,["executableCode"]);l!=null&&s(e,["executableCode"],l);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],a);const u=r(t,["functionCall"]);u!=null&&s(e,["functionCall"],u);const c=r(t,["functionResponse"]);c!=null&&s(e,["functionResponse"],c);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],d);const p=r(t,["text"]);return p!=null&&s(e,["text"],p),e}function Y(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>xn(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function Mn(o,t){const e={};if(r(t,["example"])!==void 0)throw new Error("example parameter is not supported in Gemini API.");if(r(t,["pattern"])!==void 0)throw new Error("pattern parameter is not supported in Gemini API.");if(r(t,["default"])!==void 0)throw new Error("default parameter is not supported in Gemini API.");if(r(t,["maxLength"])!==void 0)throw new Error("maxLength parameter is not supported in Gemini API.");if(r(t,["minLength"])!==void 0)throw new Error("minLength parameter is not supported in Gemini API.");if(r(t,["minProperties"])!==void 0)throw new Error("minProperties parameter is not supported in Gemini API.");if(r(t,["maxProperties"])!==void 0)throw new Error("maxProperties parameter is not supported in Gemini API.");const n=r(t,["anyOf"]);n!=null&&s(e,["anyOf"],n);const i=r(t,["description"]);i!=null&&s(e,["description"],i);const l=r(t,["enum"]);l!=null&&s(e,["enum"],l);const a=r(t,["format"]);a!=null&&s(e,["format"],a);const u=r(t,["items"]);u!=null&&s(e,["items"],u);const c=r(t,["maxItems"]);c!=null&&s(e,["maxItems"],c);const d=r(t,["maximum"]);d!=null&&s(e,["maximum"],d);const p=r(t,["minItems"]);p!=null&&s(e,["minItems"],p);const f=r(t,["minimum"]);f!=null&&s(e,["minimum"],f);const y=r(t,["nullable"]);y!=null&&s(e,["nullable"],y);const g=r(t,["properties"]);g!=null&&s(e,["properties"],g);const m=r(t,["propertyOrdering"]);m!=null&&s(e,["propertyOrdering"],m);const h=r(t,["required"]);h!=null&&s(e,["required"],h);const E=r(t,["title"]);E!=null&&s(e,["title"],E);const C=r(t,["type"]);return C!=null&&s(e,["type"],C),e}function Sn(o,t){const e={};if(r(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=r(t,["category"]);n!=null&&s(e,["category"],n);const i=r(t,["threshold"]);return i!=null&&s(e,["threshold"],i),e}function Pn(o,t){const e={};if(r(t,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=r(t,["description"]);n!=null&&s(e,["description"],n);const i=r(t,["name"]);i!=null&&s(e,["name"],i);const l=r(t,["parameters"]);return l!=null&&s(e,["parameters"],l),e}function Rn(){return{}}function bn(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["dynamicThreshold"]);return i!=null&&s(e,["dynamicThreshold"],i),e}function Nn(o,t){const e={},n=r(t,["dynamicRetrievalConfig"]);return n!=null&&s(e,["dynamicRetrievalConfig"],bn(o,n)),e}function ct(o,t){const e={},n=r(t,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?s(e,["functionDeclarations"],n.map(u=>Pn(o,u))):s(e,["functionDeclarations"],n)),r(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");r(t,["googleSearch"])!=null&&s(e,["googleSearch"],Rn());const l=r(t,["googleSearchRetrieval"]);l!=null&&s(e,["googleSearchRetrieval"],Nn(o,l));const a=r(t,["codeExecution"]);return a!=null&&s(e,["codeExecution"],a),e}function Dn(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["allowedFunctionNames"]);return i!=null&&s(e,["allowedFunctionNames"],i),e}function Ln(o,t){const e={},n=r(t,["functionCallingConfig"]);return n!=null&&s(e,["functionCallingConfig"],Dn(o,n)),e}function Vn(o,t){const e={},n=r(t,["voiceName"]);return n!=null&&s(e,["voiceName"],n),e}function Fn(o,t){const e={},n=r(t,["prebuiltVoiceConfig"]);return n!=null&&s(e,["prebuiltVoiceConfig"],Vn(o,n)),e}function kn(o,t){const e={},n=r(t,["voiceConfig"]);return n!=null&&s(e,["voiceConfig"],Fn(o,n)),e}function Un(o,t){const e={},n=r(t,["includeThoughts"]);return n!=null&&s(e,["includeThoughts"],n),e}function Bn(o,t,e){const n={},i=r(t,["systemInstruction"]);e!==void 0&&i!=null&&s(e,["systemInstruction"],Y(o,b(o,i)));const l=r(t,["temperature"]);l!=null&&s(n,["temperature"],l);const a=r(t,["topP"]);a!=null&&s(n,["topP"],a);const u=r(t,["topK"]);u!=null&&s(n,["topK"],u);const c=r(t,["candidateCount"]);c!=null&&s(n,["candidateCount"],c);const d=r(t,["maxOutputTokens"]);d!=null&&s(n,["maxOutputTokens"],d);const p=r(t,["stopSequences"]);p!=null&&s(n,["stopSequences"],p);const f=r(t,["responseLogprobs"]);f!=null&&s(n,["responseLogprobs"],f);const y=r(t,["logprobs"]);y!=null&&s(n,["logprobs"],y);const g=r(t,["presencePenalty"]);g!=null&&s(n,["presencePenalty"],g);const m=r(t,["frequencyPenalty"]);m!=null&&s(n,["frequencyPenalty"],m);const h=r(t,["seed"]);h!=null&&s(n,["seed"],h);const E=r(t,["responseMimeType"]);E!=null&&s(n,["responseMimeType"],E);const C=r(t,["responseSchema"]);if(C!=null&&s(n,["responseSchema"],Mn(o,ot(o,C))),r(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");const v=r(t,["safetySettings"]);e!==void 0&&v!=null&&(Array.isArray(v)?s(e,["safetySettings"],v.map(L=>Sn(o,L))):s(e,["safetySettings"],v));const T=r(t,["tools"]);e!==void 0&&T!=null&&(Array.isArray(T)?s(e,["tools"],U(o,U(o,T).map(L=>ct(o,st(o,L))))):s(e,["tools"],U(o,T)));const I=r(t,["toolConfig"]);if(e!==void 0&&I!=null&&s(e,["toolConfig"],Ln(o,I)),r(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=r(t,["cachedContent"]);e!==void 0&&w!=null&&s(e,["cachedContent"],V(o,w));const x=r(t,["responseModalities"]);x!=null&&s(n,["responseModalities"],x);const M=r(t,["mediaResolution"]);M!=null&&s(n,["mediaResolution"],M);const S=r(t,["speechConfig"]);if(S!=null&&s(n,["speechConfig"],kn(o,it(o,S))),r(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=r(t,["thinkingConfig"]);return N!=null&&s(n,["thinkingConfig"],Un(o,N)),n}function $e(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&(Array.isArray(i)?s(e,["contents"],A(o,A(o,i).map(a=>Y(o,a)))):s(e,["contents"],A(o,i)));const l=r(t,["config"]);return l!=null&&s(e,["generationConfig"],Bn(o,l,e)),e}function qn(o,t,e){const n={},i=r(t,["taskType"]);e!==void 0&&i!=null&&s(e,["requests[]","taskType"],i);const l=r(t,["title"]);e!==void 0&&l!=null&&s(e,["requests[]","title"],l);const a=r(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&s(e,["requests[]","outputDimensionality"],a),r(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(r(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Gn(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&s(e,["requests[]","content"],nt(o,i));const l=r(t,["config"]);l!=null&&s(e,["config"],qn(o,l,e));const a=r(t,["model"]);return a!==void 0&&s(e,["requests[]","model"],R(o,a)),e}function Hn(o,t,e){const n={};if(r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=r(t,["numberOfImages"]);e!==void 0&&i!=null&&s(e,["parameters","sampleCount"],i);const l=r(t,["aspectRatio"]);e!==void 0&&l!=null&&s(e,["parameters","aspectRatio"],l);const a=r(t,["guidanceScale"]);if(e!==void 0&&a!=null&&s(e,["parameters","guidanceScale"],a),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=r(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&s(e,["parameters","safetySetting"],u);const c=r(t,["personGeneration"]);e!==void 0&&c!=null&&s(e,["parameters","personGeneration"],c);const d=r(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&s(e,["parameters","includeSafetyAttributes"],d);const p=r(t,["includeRaiReason"]);e!==void 0&&p!=null&&s(e,["parameters","includeRaiReason"],p);const f=r(t,["language"]);e!==void 0&&f!=null&&s(e,["parameters","language"],f);const y=r(t,["outputMimeType"]);e!==void 0&&y!=null&&s(e,["parameters","outputOptions","mimeType"],y);const g=r(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&s(e,["parameters","outputOptions","compressionQuality"],g),r(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function $n(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["prompt"]);i!=null&&s(e,["instances[0]","prompt"],i);const l=r(t,["config"]);return l!=null&&s(e,["config"],Hn(o,l,e)),e}function On(o,t){const e={};if(r(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(r(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(r(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function zn(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&(Array.isArray(i)?s(e,["contents"],A(o,A(o,i).map(a=>Y(o,a)))):s(e,["contents"],A(o,i)));const l=r(t,["config"]);return l!=null&&s(e,["config"],On(o,l)),e}function Yn(o,t){const e={};if(r(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=r(t,["imageBytes"]);n!=null&&s(e,["bytesBase64Encoded"],F(o,n));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}function Kn(o,t,e){const n={},i=r(t,["numberOfVideos"]);if(e!==void 0&&i!=null&&s(e,["parameters","sampleCount"],i),r(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(r(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=r(t,["durationSeconds"]);if(e!==void 0&&l!=null&&s(e,["parameters","durationSeconds"],l),r(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=r(t,["aspectRatio"]);if(e!==void 0&&a!=null&&s(e,["parameters","aspectRatio"],a),r(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=r(t,["personGeneration"]);if(e!==void 0&&u!=null&&s(e,["parameters","personGeneration"],u),r(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=r(t,["negativePrompt"]);if(e!==void 0&&c!=null&&s(e,["parameters","negativePrompt"],c),r(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Jn(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["prompt"]);i!=null&&s(e,["instances[0]","prompt"],i);const l=r(t,["image"]);l!=null&&s(e,["instances[0]","image"],Yn(o,l));const a=r(t,["config"]);return a!=null&&s(e,["config"],Kn(o,a,e)),e}function Wn(o,t){const e={},n=r(t,["videoMetadata"]);n!=null&&s(e,["videoMetadata"],n);const i=r(t,["thought"]);i!=null&&s(e,["thought"],i);const l=r(t,["codeExecutionResult"]);l!=null&&s(e,["codeExecutionResult"],l);const a=r(t,["executableCode"]);a!=null&&s(e,["executableCode"],a);const u=r(t,["fileData"]);u!=null&&s(e,["fileData"],u);const c=r(t,["functionCall"]);c!=null&&s(e,["functionCall"],c);const d=r(t,["functionResponse"]);d!=null&&s(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&s(e,["inlineData"],p);const f=r(t,["text"]);return f!=null&&s(e,["text"],f),e}function k(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>Wn(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function dt(o,t){const e={},n=r(t,["example"]);n!=null&&s(e,["example"],n);const i=r(t,["pattern"]);i!=null&&s(e,["pattern"],i);const l=r(t,["default"]);l!=null&&s(e,["default"],l);const a=r(t,["maxLength"]);a!=null&&s(e,["maxLength"],a);const u=r(t,["minLength"]);u!=null&&s(e,["minLength"],u);const c=r(t,["minProperties"]);c!=null&&s(e,["minProperties"],c);const d=r(t,["maxProperties"]);d!=null&&s(e,["maxProperties"],d);const p=r(t,["anyOf"]);p!=null&&s(e,["anyOf"],p);const f=r(t,["description"]);f!=null&&s(e,["description"],f);const y=r(t,["enum"]);y!=null&&s(e,["enum"],y);const g=r(t,["format"]);g!=null&&s(e,["format"],g);const m=r(t,["items"]);m!=null&&s(e,["items"],m);const h=r(t,["maxItems"]);h!=null&&s(e,["maxItems"],h);const E=r(t,["maximum"]);E!=null&&s(e,["maximum"],E);const C=r(t,["minItems"]);C!=null&&s(e,["minItems"],C);const v=r(t,["minimum"]);v!=null&&s(e,["minimum"],v);const T=r(t,["nullable"]);T!=null&&s(e,["nullable"],T);const I=r(t,["properties"]);I!=null&&s(e,["properties"],I);const w=r(t,["propertyOrdering"]);w!=null&&s(e,["propertyOrdering"],w);const x=r(t,["required"]);x!=null&&s(e,["required"],x);const M=r(t,["title"]);M!=null&&s(e,["title"],M);const S=r(t,["type"]);return S!=null&&s(e,["type"],S),e}function Xn(o,t){const e={},n=r(t,["method"]);n!=null&&s(e,["method"],n);const i=r(t,["category"]);i!=null&&s(e,["category"],i);const l=r(t,["threshold"]);return l!=null&&s(e,["threshold"],l),e}function Qn(o,t){const e={},n=r(t,["response"]);n!=null&&s(e,["response"],dt(o,n));const i=r(t,["description"]);i!=null&&s(e,["description"],i);const l=r(t,["name"]);l!=null&&s(e,["name"],l);const a=r(t,["parameters"]);return a!=null&&s(e,["parameters"],a),e}function Zn(){return{}}function jn(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["dynamicThreshold"]);return i!=null&&s(e,["dynamicThreshold"],i),e}function eo(o,t){const e={},n=r(t,["dynamicRetrievalConfig"]);return n!=null&&s(e,["dynamicRetrievalConfig"],jn(o,n)),e}function ae(o,t){const e={},n=r(t,["functionDeclarations"]);n!=null&&(Array.isArray(n)?s(e,["functionDeclarations"],n.map(c=>Qn(o,c))):s(e,["functionDeclarations"],n));const i=r(t,["retrieval"]);i!=null&&s(e,["retrieval"],i),r(t,["googleSearch"])!=null&&s(e,["googleSearch"],Zn());const a=r(t,["googleSearchRetrieval"]);a!=null&&s(e,["googleSearchRetrieval"],eo(o,a));const u=r(t,["codeExecution"]);return u!=null&&s(e,["codeExecution"],u),e}function to(o,t){const e={},n=r(t,["mode"]);n!=null&&s(e,["mode"],n);const i=r(t,["allowedFunctionNames"]);return i!=null&&s(e,["allowedFunctionNames"],i),e}function no(o,t){const e={},n=r(t,["functionCallingConfig"]);return n!=null&&s(e,["functionCallingConfig"],to(o,n)),e}function oo(o,t){const e={},n=r(t,["voiceName"]);return n!=null&&s(e,["voiceName"],n),e}function io(o,t){const e={},n=r(t,["prebuiltVoiceConfig"]);return n!=null&&s(e,["prebuiltVoiceConfig"],oo(o,n)),e}function so(o,t){const e={},n=r(t,["voiceConfig"]);return n!=null&&s(e,["voiceConfig"],io(o,n)),e}function ro(o,t){const e={},n=r(t,["includeThoughts"]);return n!=null&&s(e,["includeThoughts"],n),e}function lo(o,t,e){const n={},i=r(t,["systemInstruction"]);e!==void 0&&i!=null&&s(e,["systemInstruction"],k(o,b(o,i)));const l=r(t,["temperature"]);l!=null&&s(n,["temperature"],l);const a=r(t,["topP"]);a!=null&&s(n,["topP"],a);const u=r(t,["topK"]);u!=null&&s(n,["topK"],u);const c=r(t,["candidateCount"]);c!=null&&s(n,["candidateCount"],c);const d=r(t,["maxOutputTokens"]);d!=null&&s(n,["maxOutputTokens"],d);const p=r(t,["stopSequences"]);p!=null&&s(n,["stopSequences"],p);const f=r(t,["responseLogprobs"]);f!=null&&s(n,["responseLogprobs"],f);const y=r(t,["logprobs"]);y!=null&&s(n,["logprobs"],y);const g=r(t,["presencePenalty"]);g!=null&&s(n,["presencePenalty"],g);const m=r(t,["frequencyPenalty"]);m!=null&&s(n,["frequencyPenalty"],m);const h=r(t,["seed"]);h!=null&&s(n,["seed"],h);const E=r(t,["responseMimeType"]);E!=null&&s(n,["responseMimeType"],E);const C=r(t,["responseSchema"]);C!=null&&s(n,["responseSchema"],dt(o,ot(o,C)));const v=r(t,["routingConfig"]);v!=null&&s(n,["routingConfig"],v);const T=r(t,["safetySettings"]);e!==void 0&&T!=null&&(Array.isArray(T)?s(e,["safetySettings"],T.map(oe=>Xn(o,oe))):s(e,["safetySettings"],T));const I=r(t,["tools"]);e!==void 0&&I!=null&&(Array.isArray(I)?s(e,["tools"],U(o,U(o,I).map(oe=>ae(o,st(o,oe))))):s(e,["tools"],U(o,I)));const w=r(t,["toolConfig"]);e!==void 0&&w!=null&&s(e,["toolConfig"],no(o,w));const x=r(t,["labels"]);e!==void 0&&x!=null&&s(e,["labels"],x);const M=r(t,["cachedContent"]);e!==void 0&&M!=null&&s(e,["cachedContent"],V(o,M));const S=r(t,["responseModalities"]);S!=null&&s(n,["responseModalities"],S);const N=r(t,["mediaResolution"]);N!=null&&s(n,["mediaResolution"],N);const L=r(t,["speechConfig"]);L!=null&&s(n,["speechConfig"],so(o,it(o,L)));const B=r(t,["audioTimestamp"]);B!=null&&s(n,["audioTimestamp"],B);const q=r(t,["thinkingConfig"]);return q!=null&&s(n,["thinkingConfig"],ro(o,q)),n}function Oe(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&(Array.isArray(i)?s(e,["contents"],A(o,A(o,i).map(a=>k(o,a)))):s(e,["contents"],A(o,i)));const l=r(t,["config"]);return l!=null&&s(e,["generationConfig"],lo(o,l,e)),e}function ao(o,t,e){const n={},i=r(t,["taskType"]);e!==void 0&&i!=null&&s(e,["instances[]","task_type"],i);const l=r(t,["title"]);e!==void 0&&l!=null&&s(e,["instances[]","title"],l);const a=r(t,["outputDimensionality"]);e!==void 0&&a!=null&&s(e,["parameters","outputDimensionality"],a);const u=r(t,["mimeType"]);e!==void 0&&u!=null&&s(e,["instances[]","mimeType"],u);const c=r(t,["autoTruncate"]);return e!==void 0&&c!=null&&s(e,["parameters","autoTruncate"],c),n}function uo(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&s(e,["instances[]","content"],nt(o,i));const l=r(t,["config"]);return l!=null&&s(e,["config"],ao(o,l,e)),e}function co(o,t,e){const n={},i=r(t,["outputGcsUri"]);e!==void 0&&i!=null&&s(e,["parameters","storageUri"],i);const l=r(t,["negativePrompt"]);e!==void 0&&l!=null&&s(e,["parameters","negativePrompt"],l);const a=r(t,["numberOfImages"]);e!==void 0&&a!=null&&s(e,["parameters","sampleCount"],a);const u=r(t,["aspectRatio"]);e!==void 0&&u!=null&&s(e,["parameters","aspectRatio"],u);const c=r(t,["guidanceScale"]);e!==void 0&&c!=null&&s(e,["parameters","guidanceScale"],c);const d=r(t,["seed"]);e!==void 0&&d!=null&&s(e,["parameters","seed"],d);const p=r(t,["safetyFilterLevel"]);e!==void 0&&p!=null&&s(e,["parameters","safetySetting"],p);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&s(e,["parameters","personGeneration"],f);const y=r(t,["includeSafetyAttributes"]);e!==void 0&&y!=null&&s(e,["parameters","includeSafetyAttributes"],y);const g=r(t,["includeRaiReason"]);e!==void 0&&g!=null&&s(e,["parameters","includeRaiReason"],g);const m=r(t,["language"]);e!==void 0&&m!=null&&s(e,["parameters","language"],m);const h=r(t,["outputMimeType"]);e!==void 0&&h!=null&&s(e,["parameters","outputOptions","mimeType"],h);const E=r(t,["outputCompressionQuality"]);e!==void 0&&E!=null&&s(e,["parameters","outputOptions","compressionQuality"],E);const C=r(t,["addWatermark"]);e!==void 0&&C!=null&&s(e,["parameters","addWatermark"],C);const v=r(t,["enhancePrompt"]);return e!==void 0&&v!=null&&s(e,["parameters","enhancePrompt"],v),n}function po(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["prompt"]);i!=null&&s(e,["instances[0]","prompt"],i);const l=r(t,["config"]);return l!=null&&s(e,["config"],co(o,l,e)),e}function fo(o,t,e){const n={},i=r(t,["systemInstruction"]);e!==void 0&&i!=null&&s(e,["systemInstruction"],k(o,b(o,i)));const l=r(t,["tools"]);e!==void 0&&l!=null&&(Array.isArray(l)?s(e,["tools"],l.map(u=>ae(o,u))):s(e,["tools"],l));const a=r(t,["generationConfig"]);return e!==void 0&&a!=null&&s(e,["generationConfig"],a),n}function mo(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&(Array.isArray(i)?s(e,["contents"],A(o,A(o,i).map(a=>k(o,a)))):s(e,["contents"],A(o,i)));const l=r(t,["config"]);return l!=null&&s(e,["config"],fo(o,l,e)),e}function ho(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["contents"]);i!=null&&(Array.isArray(i)?s(e,["contents"],A(o,A(o,i).map(a=>k(o,a)))):s(e,["contents"],A(o,i)));const l=r(t,["config"]);return l!=null&&s(e,["config"],l),e}function go(o,t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["gcsUri"],n);const i=r(t,["imageBytes"]);i!=null&&s(e,["bytesBase64Encoded"],F(o,i));const l=r(t,["mimeType"]);return l!=null&&s(e,["mimeType"],l),e}function yo(o,t,e){const n={},i=r(t,["numberOfVideos"]);e!==void 0&&i!=null&&s(e,["parameters","sampleCount"],i);const l=r(t,["outputGcsUri"]);e!==void 0&&l!=null&&s(e,["parameters","storageUri"],l);const a=r(t,["fps"]);e!==void 0&&a!=null&&s(e,["parameters","fps"],a);const u=r(t,["durationSeconds"]);e!==void 0&&u!=null&&s(e,["parameters","durationSeconds"],u);const c=r(t,["seed"]);e!==void 0&&c!=null&&s(e,["parameters","seed"],c);const d=r(t,["aspectRatio"]);e!==void 0&&d!=null&&s(e,["parameters","aspectRatio"],d);const p=r(t,["resolution"]);e!==void 0&&p!=null&&s(e,["parameters","resolution"],p);const f=r(t,["personGeneration"]);e!==void 0&&f!=null&&s(e,["parameters","personGeneration"],f);const y=r(t,["pubsubTopic"]);e!==void 0&&y!=null&&s(e,["parameters","pubsubTopic"],y);const g=r(t,["negativePrompt"]);e!==void 0&&g!=null&&s(e,["parameters","negativePrompt"],g);const m=r(t,["enhancePrompt"]);return e!==void 0&&m!=null&&s(e,["parameters","enhancePrompt"],m),n}function vo(o,t){const e={},n=r(t,["model"]);n!=null&&s(e,["_url","model"],R(o,n));const i=r(t,["prompt"]);i!=null&&s(e,["instances[0]","prompt"],i);const l=r(t,["image"]);l!=null&&s(e,["instances[0]","image"],go(o,l));const a=r(t,["config"]);return a!=null&&s(e,["config"],yo(o,a,e)),e}function Co(o,t){const e={},n=r(t,["thought"]);n!=null&&s(e,["thought"],n);const i=r(t,["codeExecutionResult"]);i!=null&&s(e,["codeExecutionResult"],i);const l=r(t,["executableCode"]);l!=null&&s(e,["executableCode"],l);const a=r(t,["fileData"]);a!=null&&s(e,["fileData"],a);const u=r(t,["functionCall"]);u!=null&&s(e,["functionCall"],u);const c=r(t,["functionResponse"]);c!=null&&s(e,["functionResponse"],c);const d=r(t,["inlineData"]);d!=null&&s(e,["inlineData"],d);const p=r(t,["text"]);return p!=null&&s(e,["text"],p),e}function pt(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>Co(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function Eo(o,t){const e={},n=r(t,["citationSources"]);return n!=null&&s(e,["citations"],n),e}function To(o,t){const e={},n=r(t,["content"]);n!=null&&s(e,["content"],pt(o,n));const i=r(t,["citationMetadata"]);i!=null&&s(e,["citationMetadata"],Eo(o,i));const l=r(t,["tokenCount"]);l!=null&&s(e,["tokenCount"],l);const a=r(t,["finishReason"]);a!=null&&s(e,["finishReason"],a);const u=r(t,["avgLogprobs"]);u!=null&&s(e,["avgLogprobs"],u);const c=r(t,["groundingMetadata"]);c!=null&&s(e,["groundingMetadata"],c);const d=r(t,["index"]);d!=null&&s(e,["index"],d);const p=r(t,["logprobsResult"]);p!=null&&s(e,["logprobsResult"],p);const f=r(t,["safetyRatings"]);return f!=null&&s(e,["safetyRatings"],f),e}function ze(o,t){const e={},n=r(t,["candidates"]);n!=null&&(Array.isArray(n)?s(e,["candidates"],n.map(u=>To(o,u))):s(e,["candidates"],n));const i=r(t,["modelVersion"]);i!=null&&s(e,["modelVersion"],i);const l=r(t,["promptFeedback"]);l!=null&&s(e,["promptFeedback"],l);const a=r(t,["usageMetadata"]);return a!=null&&s(e,["usageMetadata"],a),e}function Io(o,t){const e={},n=r(t,["values"]);return n!=null&&s(e,["values"],n),e}function _o(){return{}}function wo(o,t){const e={},n=r(t,["embeddings"]);return n!=null&&(Array.isArray(n)?s(e,["embeddings"],n.map(l=>Io(o,l))):s(e,["embeddings"],n)),r(t,["metadata"])!=null&&s(e,["metadata"],_o()),e}function Ao(o,t){const e={},n=r(t,["bytesBase64Encoded"]);n!=null&&s(e,["imageBytes"],F(o,n));const i=r(t,["mimeType"]);return i!=null&&s(e,["mimeType"],i),e}function ft(o,t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&s(e,["categories"],n);const i=r(t,["safetyAttributes","scores"]);i!=null&&s(e,["scores"],i);const l=r(t,["contentType"]);return l!=null&&s(e,["contentType"],l),e}function xo(o,t){const e={},n=r(t,["_self"]);n!=null&&s(e,["image"],Ao(o,n));const i=r(t,["raiFilteredReason"]);i!=null&&s(e,["raiFilteredReason"],i);const l=r(t,["_self"]);return l!=null&&s(e,["safetyAttributes"],ft(o,l)),e}function Mo(o,t){const e={},n=r(t,["predictions"]);n!=null&&(Array.isArray(n)?s(e,["generatedImages"],n.map(l=>xo(o,l))):s(e,["generatedImages"],n));const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&s(e,["positivePromptSafetyAttributes"],ft(o,i)),e}function So(o,t){const e={},n=r(t,["totalTokens"]);n!=null&&s(e,["totalTokens"],n);const i=r(t,["cachedContentTokenCount"]);return i!=null&&s(e,["cachedContentTokenCount"],i),e}function Po(o,t){const e={},n=r(t,["video","uri"]);n!=null&&s(e,["uri"],n);const i=r(t,["video","encodedVideo"]);i!=null&&s(e,["videoBytes"],F(o,i));const l=r(t,["encoding"]);return l!=null&&s(e,["mimeType"],l),e}function Ro(o,t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],Po(o,n)),e}function bo(o,t){const e={},n=r(t,["generatedSamples"]);n!=null&&(Array.isArray(n)?s(e,["generatedVideos"],n.map(a=>Ro(o,a))):s(e,["generatedVideos"],n));const i=r(t,["raiMediaFilteredCount"]);i!=null&&s(e,["raiMediaFilteredCount"],i);const l=r(t,["raiMediaFilteredReasons"]);return l!=null&&s(e,["raiMediaFilteredReasons"],l),e}function No(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["metadata"]);i!=null&&s(e,["metadata"],i);const l=r(t,["done"]);l!=null&&s(e,["done"],l);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const u=r(t,["response"]);u!=null&&s(e,["response"],u);const c=r(t,["response","generateVideoResponse"]);return c!=null&&s(e,["result"],bo(o,c)),e}function Do(o,t){const e={},n=r(t,["videoMetadata"]);n!=null&&s(e,["videoMetadata"],n);const i=r(t,["thought"]);i!=null&&s(e,["thought"],i);const l=r(t,["codeExecutionResult"]);l!=null&&s(e,["codeExecutionResult"],l);const a=r(t,["executableCode"]);a!=null&&s(e,["executableCode"],a);const u=r(t,["fileData"]);u!=null&&s(e,["fileData"],u);const c=r(t,["functionCall"]);c!=null&&s(e,["functionCall"],c);const d=r(t,["functionResponse"]);d!=null&&s(e,["functionResponse"],d);const p=r(t,["inlineData"]);p!=null&&s(e,["inlineData"],p);const f=r(t,["text"]);return f!=null&&s(e,["text"],f),e}function mt(o,t){const e={},n=r(t,["parts"]);n!=null&&(Array.isArray(n)?s(e,["parts"],n.map(l=>Do(o,l))):s(e,["parts"],n));const i=r(t,["role"]);return i!=null&&s(e,["role"],i),e}function Lo(o,t){const e={},n=r(t,["citations"]);return n!=null&&s(e,["citations"],n),e}function Vo(o,t){const e={},n=r(t,["content"]);n!=null&&s(e,["content"],mt(o,n));const i=r(t,["citationMetadata"]);i!=null&&s(e,["citationMetadata"],Lo(o,i));const l=r(t,["finishMessage"]);l!=null&&s(e,["finishMessage"],l);const a=r(t,["finishReason"]);a!=null&&s(e,["finishReason"],a);const u=r(t,["avgLogprobs"]);u!=null&&s(e,["avgLogprobs"],u);const c=r(t,["groundingMetadata"]);c!=null&&s(e,["groundingMetadata"],c);const d=r(t,["index"]);d!=null&&s(e,["index"],d);const p=r(t,["logprobsResult"]);p!=null&&s(e,["logprobsResult"],p);const f=r(t,["safetyRatings"]);return f!=null&&s(e,["safetyRatings"],f),e}function Ye(o,t){const e={},n=r(t,["candidates"]);n!=null&&(Array.isArray(n)?s(e,["candidates"],n.map(d=>Vo(o,d))):s(e,["candidates"],n));const i=r(t,["createTime"]);i!=null&&s(e,["createTime"],i);const l=r(t,["responseId"]);l!=null&&s(e,["responseId"],l);const a=r(t,["modelVersion"]);a!=null&&s(e,["modelVersion"],a);const u=r(t,["promptFeedback"]);u!=null&&s(e,["promptFeedback"],u);const c=r(t,["usageMetadata"]);return c!=null&&s(e,["usageMetadata"],c),e}function Fo(o,t){const e={},n=r(t,["truncated"]);n!=null&&s(e,["truncated"],n);const i=r(t,["token_count"]);return i!=null&&s(e,["tokenCount"],i),e}function ko(o,t){const e={},n=r(t,["values"]);n!=null&&s(e,["values"],n);const i=r(t,["statistics"]);return i!=null&&s(e,["statistics"],Fo(o,i)),e}function Uo(o,t){const e={},n=r(t,["billableCharacterCount"]);return n!=null&&s(e,["billableCharacterCount"],n),e}function Bo(o,t){const e={},n=r(t,["predictions[]","embeddings"]);n!=null&&(Array.isArray(n)?s(e,["embeddings"],n.map(l=>ko(o,l))):s(e,["embeddings"],n));const i=r(t,["metadata"]);return i!=null&&s(e,["metadata"],Uo(o,i)),e}function qo(o,t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["gcsUri"],n);const i=r(t,["bytesBase64Encoded"]);i!=null&&s(e,["imageBytes"],F(o,i));const l=r(t,["mimeType"]);return l!=null&&s(e,["mimeType"],l),e}function ht(o,t){const e={},n=r(t,["safetyAttributes","categories"]);n!=null&&s(e,["categories"],n);const i=r(t,["safetyAttributes","scores"]);i!=null&&s(e,["scores"],i);const l=r(t,["contentType"]);return l!=null&&s(e,["contentType"],l),e}function Go(o,t){const e={},n=r(t,["_self"]);n!=null&&s(e,["image"],qo(o,n));const i=r(t,["raiFilteredReason"]);i!=null&&s(e,["raiFilteredReason"],i);const l=r(t,["_self"]);l!=null&&s(e,["safetyAttributes"],ht(o,l));const a=r(t,["prompt"]);return a!=null&&s(e,["enhancedPrompt"],a),e}function Ho(o,t){const e={},n=r(t,["predictions"]);n!=null&&(Array.isArray(n)?s(e,["generatedImages"],n.map(l=>Go(o,l))):s(e,["generatedImages"],n));const i=r(t,["positivePromptSafetyAttributes"]);return i!=null&&s(e,["positivePromptSafetyAttributes"],ht(o,i)),e}function $o(o,t){const e={},n=r(t,["totalTokens"]);return n!=null&&s(e,["totalTokens"],n),e}function Oo(o,t){const e={},n=r(t,["tokensInfo"]);return n!=null&&s(e,["tokensInfo"],n),e}function zo(o,t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["uri"],n);const i=r(t,["bytesBase64Encoded"]);i!=null&&s(e,["videoBytes"],F(o,i));const l=r(t,["mimeType"]);return l!=null&&s(e,["mimeType"],l),e}function Yo(o,t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],zo(o,n)),e}function Ko(o,t){const e={},n=r(t,["videos"]);n!=null&&(Array.isArray(n)?s(e,["generatedVideos"],n.map(a=>Yo(o,a))):s(e,["generatedVideos"],n));const i=r(t,["raiMediaFilteredCount"]);i!=null&&s(e,["raiMediaFilteredCount"],i);const l=r(t,["raiMediaFilteredReasons"]);return l!=null&&s(e,["raiMediaFilteredReasons"],l),e}function Jo(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["metadata"]);i!=null&&s(e,["metadata"],i);const l=r(t,["done"]);l!=null&&s(e,["done"],l);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const u=r(t,["response"]);u!=null&&s(e,["response"],u);const c=r(t,["response"]);return c!=null&&s(e,["result"],Ko(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wo(o,t){const e={},n=r(t,["config"]);n!=null&&s(e,["setup"],jo(o,n));const i=r(t,["model"]);return i!==void 0&&s(e,["setup","model"],i),e}function Xo(o,t){const e={},n=r(t,["config"]);n!=null&&s(e,["setup"],ei(o,n));const i=r(t,["model"]);return i!==void 0&&s(e,["setup","model"],i),e}function Qo(o,t){const e={},n=r(t,["setupComplete"]);n!==void 0&&s(e,["setupComplete"],n);const i=r(t,["serverContent"]);i!=null&&s(e,["serverContent"],ti(o,i));const l=r(t,["toolCall"]);l!=null&&s(e,["toolCall"],si(o,l));const a=r(t,["toolCallCancellation"]);return a!=null&&s(e,["toolCallCancellation"],li(o,a)),e}function Zo(o,t){const e={},n=r(t,["setupComplete"]);n!==void 0&&s(e,["setupComplete"],n);const i=r(t,["serverContent"]);i!=null&&s(e,["serverContent"],ni(o,i));const l=r(t,["toolCall"]);l!=null&&s(e,["toolCall"],ri(o,l));const a=r(t,["toolCallCancellation"]);return a!=null&&s(e,["toolCallCancellation"],ai(o,a)),e}function jo(o,t){const e={},n=r(t,["generationConfig"]);n!==void 0&&s(e,["generationConfig"],n);const i=r(t,["responseModalities"]);i!==void 0&&s(e,["generationConfig","responseModalities"],i);const l=r(t,["speechConfig"]);l!==void 0&&s(e,["generationConfig","speechConfig"],l);const a=r(t,["systemInstruction"]);a!=null&&s(e,["systemInstruction"],Y(o,a));const u=r(t,["tools"]);return u!=null&&Array.isArray(u)&&s(e,["tools"],u.map(c=>ct(o,c))),e}function ei(o,t){const e={},n=r(t,["generationConfig"]);n!==void 0&&s(e,["generationConfig"],n);const i=r(t,["responseModalities"]);i!==void 0?s(e,["generationConfig","responseModalities"],i):s(e,["generationConfig","responseModalities"],["AUDIO"]);const l=r(t,["speechConfig"]);l!==void 0&&s(e,["generationConfig","speechConfig"],l);const a=r(t,["systemInstruction"]);a!=null&&s(e,["systemInstruction"],k(o,a));const u=r(t,["tools"]);return u!=null&&Array.isArray(u)&&s(e,["tools"],u.map(c=>ae(o,c))),e}function ti(o,t){const e={},n=r(t,["modelTurn"]);n!=null&&s(e,["modelTurn"],pt(o,n));const i=r(t,["turnComplete"]);i!==void 0&&s(e,["turnComplete"],i);const l=r(t,["interrupted"]);return l!==void 0&&s(e,["interrupted"],l),e}function ni(o,t){const e={},n=r(t,["modelTurn"]);n!=null&&s(e,["modelTurn"],mt(o,n));const i=r(t,["turnComplete"]);i!==void 0&&s(e,["turnComplete"],i);const l=r(t,["interrupted"]);return l!==void 0&&s(e,["interrupted"],l),e}function oi(o,t){const e={},n=r(t,["id"]);n!==void 0&&s(e,["id"],n);const i=r(t,["args"]);i!==void 0&&s(e,["args"],i);const l=r(t,["name"]);return l!==void 0&&s(e,["name"],l),e}function ii(o,t){const e={},n=r(t,["args"]);n!==void 0&&s(e,["args"],n);const i=r(t,["name"]);return i!==void 0&&s(e,["name"],i),e}function si(o,t){const e={},n=r(t,["functionCalls"]);return n!=null&&Array.isArray(n)&&s(e,["functionCalls"],n.map(i=>oi(o,i))),e}function ri(o,t){const e={},n=r(t,["functionCalls"]);return n!=null&&Array.isArray(n)&&s(e,["functionCalls"],n.map(i=>ii(o,i))),e}function li(o,t){const e={},n=r(t,["ids"]);return n!==void 0&&s(e,["ids"],n),e}function ai(o,t){const e={},n=r(t,["ids"]);return n!==void 0&&s(e,["ids"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ui="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function ci(o,t,e){let n,i;e.data instanceof Blob?i=JSON.parse(await e.data.text()):i=JSON.parse(e.data),o.isVertexAI()?n=Zo(o,i):n=Qo(o,i),t(n)}class di{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n;const i=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let a;const u=hi(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())a=`${i}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const v=this.apiClient.getApiKey();a=`${i}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${v}`}let c=()=>{};const d=new Promise(v=>{c=v}),p=t.callbacks,f=function(){var v;(v=p==null?void 0:p.onopen)===null||v===void 0||v.call(p),c({})},y=this.apiClient,g={onopen:f,onmessage:v=>{ci(y,p.onmessage,v)},onerror:(e=p==null?void 0:p.onerror)!==null&&e!==void 0?e:function(v){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(v){}},m=this.webSocketFactory.create(a,mi(u),g);m.connect(),await d;let h=R(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&h.startsWith("publishers/")){const v=this.apiClient.getProject(),T=this.apiClient.getLocation();h=`projects/${v}/locations/${T}/`+h}let E={};const C={model:h,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?E=Xo(this.apiClient,C):E=Wo(this.apiClient,C),m.send(JSON.stringify(E)),new fi(m,this.apiClient)}}const pi={turnComplete:!0};class fi{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=A(t,e.turns),t.isVertexAI()?n=n.map(i=>k(t,i)):n=n.map(i=>Y(t,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClientRealtimeInput(t,e){let n={};if(!("media"in e)||!e.media)throw new Error(`Failed to convert realtime input "media", type: '${typeof e.media}'`);return n={realtimeInput:{mediaChunks:[e.media]}},n}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const l of n){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(ui)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},pi),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){if(t.media==null)throw new Error("Media is required.");const e=this.tLiveClientRealtimeInput(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function mi(o){const t={};return o.forEach((e,n)=>{t[n]=e}),t}function hi(o){const t=new Headers;for(const[e,n]of Object.entries(o))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gi extends te{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var i;let l;const a=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l}:u={generatedImages:a},u})}async generateContentInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Oe(this.apiClient,t);return l=_("{model}:generateContent",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Ye(this.apiClient,c),p=new K;return Object.assign(p,d),p})}else{const u=$e(this.apiClient,t);return l=_("{model}:generateContent",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=ze(this.apiClient,c),p=new K;return Object.assign(p,d),p})}}async generateContentStreamInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=Oe(this.apiClient,t);l=_("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=this.apiClient;return i=c.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}),i.then(function(d){return ee(this,arguments,function*(){var p,f,y,g;try{for(var m=!0,h=ie(d),E;E=yield P(h.next()),p=E.done,!p;m=!0){g=E.value,m=!1;const v=Ye(c,g),T=new K;Object.assign(T,v),yield yield P(T)}}catch(C){f={error:C}}finally{try{!m&&!p&&(y=h.return)&&(yield P(y.call(h)))}finally{if(f)throw f.error}}})})}else{const u=$e(this.apiClient,t);l=_("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=this.apiClient;return i=c.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}),i.then(function(d){return ee(this,arguments,function*(){var p,f,y,g;try{for(var m=!0,h=ie(d),E;E=yield P(h.next()),p=E.done,!p;m=!0){g=E.value,m=!1;const v=ze(c,g),T=new K;Object.assign(T,v),yield yield P(T)}}catch(C){f={error:C}}finally{try{!m&&!p&&(y=h.return)&&(yield P(y.call(h)))}finally{if(f)throw f.error}}})})}}async embedContent(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=uo(this.apiClient,t);return l=_("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Bo(this.apiClient,c),p=new ke;return Object.assign(p,d),p})}else{const u=Gn(this.apiClient,t);return l=_("{model}:batchEmbedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=wo(this.apiClient,c),p=new ke;return Object.assign(p,d),p})}}async generateImagesInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=po(this.apiClient,t);return l=_("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Ho(this.apiClient,c),p=new Ue;return Object.assign(p,d),p})}else{const u=$n(this.apiClient,t);return l=_("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=Mo(this.apiClient,c),p=new Ue;return Object.assign(p,d),p})}}async countTokens(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=mo(this.apiClient,t);return l=_("{model}:countTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>{const d=$o(this.apiClient,c),p=new Be;return Object.assign(p,d),p})}else{const u=zn(this.apiClient,t);return l=_("{model}:countTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>{const d=So(this.apiClient,c),p=new Be;return Object.assign(p,d),p})}}async computeTokens(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI()){const a=ho(this.apiClient,t);return i=_("{model}:computeTokens",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>{const c=Oo(this.apiClient,u),d=new on;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=vo(this.apiClient,t);return l=_("{model}:predictLongRunning",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Jo(this.apiClient,c))}else{const u=Jn(this.apiClient,t);return l=_("{model}:predictLongRunning",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>No(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yi(o,t){const e={},n=r(t,["operationName"]);n!=null&&s(e,["_url","operationName"],n);const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function vi(o,t){const e={},n=r(t,["operationName"]);n!=null&&s(e,["_url","operationName"],n);const i=r(t,["config"]);return i!=null&&s(e,["config"],i),e}function Ci(o,t){const e={},n=r(t,["operationName"]);n!=null&&s(e,["operationName"],n);const i=r(t,["resourceName"]);i!=null&&s(e,["_url","resourceName"],i);const l=r(t,["config"]);return l!=null&&s(e,["config"],l),e}function Ei(o,t){const e={},n=r(t,["video","uri"]);n!=null&&s(e,["uri"],n);const i=r(t,["video","encodedVideo"]);i!=null&&s(e,["videoBytes"],F(o,i));const l=r(t,["encoding"]);return l!=null&&s(e,["mimeType"],l),e}function Ti(o,t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],Ei(o,n)),e}function Ii(o,t){const e={},n=r(t,["generatedSamples"]);n!=null&&(Array.isArray(n)?s(e,["generatedVideos"],n.map(a=>Ti(o,a))):s(e,["generatedVideos"],n));const i=r(t,["raiMediaFilteredCount"]);i!=null&&s(e,["raiMediaFilteredCount"],i);const l=r(t,["raiMediaFilteredReasons"]);return l!=null&&s(e,["raiMediaFilteredReasons"],l),e}function _i(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["metadata"]);i!=null&&s(e,["metadata"],i);const l=r(t,["done"]);l!=null&&s(e,["done"],l);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const u=r(t,["response"]);u!=null&&s(e,["response"],u);const c=r(t,["response","generateVideoResponse"]);return c!=null&&s(e,["result"],Ii(o,c)),e}function wi(o,t){const e={},n=r(t,["gcsUri"]);n!=null&&s(e,["uri"],n);const i=r(t,["bytesBase64Encoded"]);i!=null&&s(e,["videoBytes"],F(o,i));const l=r(t,["mimeType"]);return l!=null&&s(e,["mimeType"],l),e}function Ai(o,t){const e={},n=r(t,["_self"]);return n!=null&&s(e,["video"],wi(o,n)),e}function xi(o,t){const e={},n=r(t,["videos"]);n!=null&&(Array.isArray(n)?s(e,["generatedVideos"],n.map(a=>Ai(o,a))):s(e,["generatedVideos"],n));const i=r(t,["raiMediaFilteredCount"]);i!=null&&s(e,["raiMediaFilteredCount"],i);const l=r(t,["raiMediaFilteredReasons"]);return l!=null&&s(e,["raiMediaFilteredReasons"],l),e}function Ke(o,t){const e={},n=r(t,["name"]);n!=null&&s(e,["name"],n);const i=r(t,["metadata"]);i!=null&&s(e,["metadata"],i);const l=r(t,["done"]);l!=null&&s(e,["done"],l);const a=r(t,["error"]);a!=null&&s(e,["error"],a);const u=r(t,["response"]);u!=null&&s(e,["response"],u);const c=r(t,["response"]);return c!=null&&s(e,["result"],xi(o,c)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Mi extends te{constructor(t){super(),this.apiClient=t}async get(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const l=e.name.split("/operations/")[0];var i=void 0;return n&&"httpOptions"in n&&(i=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:l,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n;let i,l="",a={};if(this.apiClient.isVertexAI()){const u=vi(this.apiClient,t);return l=_("{operationName}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),i.then(c=>Ke(this.apiClient,c))}else{const u=yi(this.apiClient,t);return l=_("{operationName}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),i.then(c=>_i(this.apiClient,c))}}async fetchPredictVideosOperationInternal(t){var e;let n,i="",l={};if(this.apiClient.isVertexAI()){const a=Ci(this.apiClient,t);return i=_("{resourceName}:fetchPredictOperation",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>Ke(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Si="Content-Type",Pi="User-Agent",Ri="x-goog-api-client",bi="0.7.0",Ni=`google-genai-sdk/${bi}`,Di="v1beta1",Li="v1beta",Je=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class Vi extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class We extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class Fi{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Di,this.getProject()||this.getLocation()?(i.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(i.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Li,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol="wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e){const n=[this.getRequestUrlInternal(e)];return this.clientOptions.vertexai&&!this.clientOptions.apiKey&&!t.startsWith("projects/")&&n.push(this.getBaseResourcePath()),t!==""&&n.push(t),new URL(`${n.join("/")}`)}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.constructUrl(t.path,e);if(t.queryParams)for(const[l,a]of Object.entries(t.queryParams))n.searchParams.append(l,String(a));let i={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=t.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,e),this.unaryApiCall(n,i,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[i,l]of Object.entries(e))typeof l=="object"?n[i]=Object.assign(Object.assign({},n[i]),l):l!==void 0&&(n[i]=l);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.constructUrl(t.path,e);(!n.searchParams.has("alt")||n.searchParams.get("alt")!=="sse")&&n.searchParams.set("alt","sse");let i={};return i.body=t.body,i=await this.includeExtraHttpOptionsToRequestInit(i,e),this.streamApiCall(n,i,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e){if(e&&e.timeout&&e.timeout>0){const n=new AbortController,i=n.signal;setTimeout(()=>n.abort(),e.timeout),t.signal=i}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await Xe(i),new at(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async i=>(await Xe(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var e;return ee(this,arguments,function*(){const i=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield P(i.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c);a+=d;let p=a.match(Je);for(;p;){const f=p[1];try{const y=JSON.parse(f);yield yield P(y),a=a.slice(p[0].length),p=a.match(Je)}catch(y){throw new Error(`exception parsing stream chunk ${f}. ${y}`)}}}}finally{i.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Ni+" "+this.clientOptions.userAgentExtra;return t[Pi]=e,t[Ri]=e,t[Si]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers)for(const[n,i]of Object.entries(t.headers))e.append(n,i);return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const i={};e!=null&&(i.mimeType=e.mimeType,i.name=e.name,i.displayName=e.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const l=this.clientOptions.uploader,a=await l.stat(t);i.sizeBytes=String(a.size);const u=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const c=await this.fetchUploadUrl(i,e);return l.upload(t,c,this)}async fetchUploadUrl(t,e){var n;let i={};e!=null&&e.httpOptions?i=e.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},a=await this.request({path:_("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:i});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Xe(o){var t;if(o===void 0)throw new We("response is undefined");if(!o.ok){const e=o.status,n=o.statusText;let i;!((t=o.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?i=await o.json():i={error:{message:"exception parsing response",code:o.status,status:o.statusText}};const l=`got status: ${e} ${n}. ${JSON.stringify(i)}`;throw e>=400&&e<500?new Vi(l):e>=500&&e<600?new We(l):new Error(l)}}const ki=1024*1024*8;async function Ui(o,t,e){var n,i;let l=0,a=0,u=new at(new Response),c="upload";for(l=o.size;a<l;){const p=Math.min(ki,l-a),f=o.slice(a,a+p);if(a+p>=l&&(c+=", finalize"),u=await e.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),a+=p,((n=u==null?void 0:u.headers)===null||n===void 0?void 0:n["x-goog-upload-status"])!=="active")break;if(l<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(u==null?void 0:u.json());if(((i=u==null?void 0:u.headers)===null||i===void 0?void 0:i["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function Bi(o){return{size:o.size,type:o.type}}class qi{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Ui(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Bi(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gi{create(t,e,n){return new Hi(t,e,n)}}class Hi{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Qe="x-goog-api-key";class $i{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(Qe)===null&&t.append(Qe,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Oi="gl-node/";class gt{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey,this.apiVersion=t.apiVersion;const n=new $i(this.apiKey);this.apiClient=new Fi({auth:n,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:Oi+"web",uploader:new qi}),this.models=new gi(this.apiClient),this.live=new di(this.apiClient,n,new Gi),this.chats=new pn(this.models,this.apiClient),this.caches=new an(this.apiClient),this.files=new An(this.apiClient),this.operations=new Mi(this.apiClient)}}/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/let O;const H="gemini-api-key",zi="AIzaSyC9DfT1Izb-2QNwUe0q1xAVqotq0up-TXc";function z(){var t;document.body.classList.add("api-key-mode");const o=document.getElementById("root");if(!o){console.error("Root element not found");return}o.innerHTML=`
    <main class="api-key-container" role="main">
      <div class="api-key-card">
        <h2>API  </h2>
        <p>   Google AI Gemini API  .</p>
        
        <div class="input-group">
          <label for="api-key-input">Gemini API Key</label>
          <input type="password" id="api-key-input" placeholder="API   " aria-label="Gemini API Key Input">
        </div>
        
        <button id="save-api-key-btn" class="cta-btn"> </button>
        
        <div class="api-key-links">
          <p>API       .</p>
          <a href="https://aistudio.google.com/app/api-keys" target="_blank" rel="noopener noreferrer">API   </a>
        </div>
      </div>
      <a href="https://blog.naver.com/inyeonhair/224041978037" class="api-key-guide-link" target="_blank" rel="noopener noreferrer">API   </a>
    </main>
  `,(t=document.getElementById("save-api-key-btn"))==null||t.addEventListener("click",()=>{const n=document.getElementById("api-key-input").value.trim();if(n)try{localStorage.setItem(H,n),O=new gt({apiKey:n}),document.body.classList.remove("api-key-mode"),ne()}catch(i){console.error("Failed to initialize GoogleGenAI:",i),alert("API    .    ."),localStorage.removeItem(H)}else alert("API  .")})}let D=null;const ue=`
  <div class="footer-container">
    <button id="change-api-key-btn" class="secondary-btn">API  </button>
    <footer class="info-footer">
      <p>[]   </p>
      <p>  100     .</p>
      <p><a href="https://www.instagram.com/inyeonhair/?hl=ko" target="_blank" rel="noopener noreferrer">@inyeonhair  </a></p>
    </footer>
  </div>
`;function ne(){var t,e,n,i,l,a,u,c;D=null;const o=document.getElementById("root");if(!o){console.error("Root element not found");return}o.innerHTML=`
    <main class="app-container" role="main">
      <header class="app-header">
        <h1>    AI </h1>
        <p>AI    & </p>
      </header>
      <div class="choice-container main-choices">
        <div class="choice-row">
          <button id="lip-choice-btn" class="choice-btn" aria-label="  ">
            <h2> </h2>
            <p>Lip Procedure</p>
          </button>
          <button id="eyebrow-choice-btn" class="choice-btn" aria-label="  ">
            <h2> </h2>
            <p>Eyebrow Procedure</p>
          </button>
        </div>
        <div class="choice-row">
          <button id="hair-choice-btn" class="choice-btn" aria-label="  ">
            <h2></h2>
            <p>Hairstyle</p>
          </button>
          <button id="clothing-choice-btn" class="choice-btn" aria-label="  ">
            <h2></h2>
            <p>Clothing</p>
          </button>
          <button id="background-choice-btn" class="choice-btn" aria-label="  ">
            <h2></h2>
            <p>Background</p>
          </button>
        </div>
        <div class="choice-row">
          <button id="image-prompt-btn" class="choice-btn" aria-label="   ">
            <h2>  </h2>
            <p>Image Prompt Generator</p>
          </button>
          <button id="video-prompt-btn" class="choice-btn" aria-label="   ">
            <h2>  </h2>
            <p>Video Prompt Generator</p>
          </button>
        </div>
      </div>
      ${ue}
    </main>
  `,(t=document.getElementById("lip-choice-btn"))==null||t.addEventListener("click",()=>G("lip")),(e=document.getElementById("eyebrow-choice-btn"))==null||e.addEventListener("click",()=>G("eyebrow")),(n=document.getElementById("hair-choice-btn"))==null||n.addEventListener("click",()=>G("hair")),(i=document.getElementById("clothing-choice-btn"))==null||i.addEventListener("click",()=>G("clothing")),(l=document.getElementById("background-choice-btn"))==null||l.addEventListener("click",()=>G("background")),(a=document.getElementById("image-prompt-btn"))==null||a.addEventListener("click",()=>Ze("image-prompt")),(u=document.getElementById("video-prompt-btn"))==null||u.addEventListener("click",()=>Ze("video-prompt")),(c=document.getElementById("change-api-key-btn"))==null||c.addEventListener("click",z)}function Ze(o){var u,c;const t=document.getElementById("root");if(!t)return;const e=o==="image-prompt"?"   ()":"  ";let n="";o==="image-prompt"?n=`
      <div style="margin-bottom: 1.5rem; text-align: center; color: var(--secondary-color);">
        (Midjourney)     <b>   </b>  .
      </div>

      <!-- Step 1: Model Info -->
      <div class="step-card">
        <h3 class="step-header">1.   ( / )</h3>
        <p class="step-desc">    .</p>
        <div class="chip-grid selection-group" data-group="gender">
            <button class="chip-btn active" data-value="Female"></button>
            <button class="chip-btn" data-value="Male"></button>
        </div>
        <div class="chip-grid selection-group" data-group="age" style="margin-top: 0.8rem;">
            <button class="chip-btn active" data-value="20s">20</button>
            <button class="chip-btn" data-value="30s">30</button>
            <button class="chip-btn" data-value="40s">40</button>
            <button class="chip-btn" data-value="50s">50</button>
            <button class="chip-btn" data-value="60s">60 </button>
        </div>
      </div>

      <!-- Step 2: Face Style -->
      <div class="step-card">
        <h3 class="step-header">2.    </h3>
        <p class="step-desc">   ?</p>
        <div class="chip-grid selection-group" data-group="face-style">
            <button class="chip-btn active" data-value="Natural and pure"> </button>
            <button class="chip-btn" data-value="K-pop idol style, glamourous">  </button>
            <button class="chip-btn" data-value="Elegant and sophisticated"> </button>
            <button class="chip-btn" data-value="Cute and lovely"> </button>
            <button class="chip-btn" data-value="Chic and sharp"> </button>
            <button class="chip-btn" data-value="Professional business look"> </button>
        </div>
      </div>

      <!-- Step 3: Lighting -->
      <div class="step-card">
        <h3 class="step-header">3.  (Lighting)</h3>
        <p class="step-desc">    .</p>
        <div class="chip-grid selection-group" data-group="lighting">
            <button class="chip-btn active" data-value="Soft even studio lighting">   ( )</button>
            <button class="chip-btn" data-value="Natural sunlight">  ( )</button>
            <button class="chip-btn" data-value="Cinematic mood lighting">    </button>
            <button class="chip-btn" data-value="Golden hour">  ()</button>
            <button class="chip-btn" data-value="Bright high-key lighting">   </button>
        </div>
      </div>

       <!-- Step 4: Expression (Replaced Background) -->
      <div class="step-card">
        <h3 class="step-header">4.  (Facial Expression)</h3>
        <p class="step-desc">     .</p>
        <div class="chip-grid selection-group" data-group="expression">
            <button class="chip-btn active" data-value="Natural neutral expression"> </button>
            <button class="chip-btn" data-value="Slight gentle smile"> </button>
            <button class="chip-btn" data-value="Bright joyful smile"> </button>
            <button class="chip-btn" data-value="Chic and serious look">/</button>
            <button class="chip-btn" data-value="Dreamy and emotional gaze">/</button>
        </div>
      </div>

       <!-- Step 5: Additional Prompt (Renumbered) -->
      <div class="step-card">
        <h3 class="step-header">5.   ()</h3>
        <p class="step-desc">, ,      .</p>
        <textarea id="image-additional-prompt" class="prompt-textarea" placeholder=":   ,   ,   "></textarea>
      </div>

      <button id="generate-prompt-btn" class="cta-btn" style="margin-top: 1rem;"> </button>
    `:n=`
      <div style="margin-bottom: 1.5rem; text-align: center; color: var(--secondary-color);">
          (Image-to-Video)   <b>    </b> .
      </div>
      
      <!-- Step 1: Movement -->
      <div class="step-card">
        <h3 class="step-header">1.  </h3>
        <p class="step-desc">  ? (  )</p>
        <div class="chip-grid multi-select-group" id="movement-chips">
            <button class="chip-btn" data-value="   ">   </button>
            <button class="chip-btn" data-value=" "> </button>
            <button class="chip-btn" data-value="  "> </button>
            <button class="chip-btn" data-value="  ">   </button>
            <button class="chip-btn" data-value="  ">  </button>
            <button class="chip-btn" data-value="  ">  </button>
            <button class="chip-btn" id="custom-movement-btn" data-value="custom"> </button>
        </div>
        <div id="custom-movement-input-wrapper" style="display: none; margin-top: 1rem; width: 100%;">
            <input type="text" id="custom-movement-input" class="prompt-textarea" style="min-height: auto; height: 50px;" placeholder=":   ">
        </div>
      </div>

      <!-- Step 2: Camera -->
      <div class="step-card">
        <h3 class="step-header">2.  </h3>
        <p class="step-desc">  ?</p>
        <div class="radio-list" id="camera-options">
            <label class="radio-item">
                <input type="radio" name="camera-move" value="none">
                <div class="radio-content">
                    <span class="radio-title">  </span>
                    <span class="radio-desc">    .</span>
                </div>
            </label>
            <label class="radio-item selected">
                <input type="radio" name="camera-move" value="static" checked>
                <div class="radio-content">
                    <span class="radio-title"> (Static)</span>
                    <span class="radio-desc">    .</span>
                </div>
            </label>
            <label class="radio-item">
                <input type="radio" name="camera-move" value="panning">
                <div class="radio-content">
                    <span class="radio-title"> (Panning)</span>
                    <span class="radio-desc">   .</span>
                </div>
            </label>
             <label class="radio-item">
                <input type="radio" name="camera-move" value="tilting">
                <div class="radio-content">
                    <span class="radio-title"> (Tilting)</span>
                    <span class="radio-desc">  .</span>
                </div>
            </label>
            <label class="radio-item">
                <input type="radio" name="camera-move" value="slow_zoom_in">
                <div class="radio-content">
                    <span class="radio-title">  (Slow Zoom In)</span>
                    <span class="radio-desc">   .</span>
                </div>
            </label>
            <label class="radio-item">
                <input type="radio" name="camera-move" value="slow_zoom_out">
                <div class="radio-content">
                    <span class="radio-title">  (Slow Zoom Out)</span>
                    <span class="radio-desc">   .</span>
                </div>
            </label>
        </div>
      </div>

      <!-- Step 3: Additional Prompt -->
      <div class="step-card">
        <h3 class="step-header">3.   ()</h3>
        <p class="step-desc">       .</p>
        <textarea id="video-additional-prompt" class="prompt-textarea" placeholder=":  "></textarea>
      </div>

      <button id="generate-prompt-btn" class="cta-btn" style="margin-top: 1rem;"> </button>
    `,t.innerHTML=`
    <main class="app-container" role="main">
      <header class="simulation-header">
        <button id="back-btn" class="back-btn" aria-label="">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        </button>
        <h1>${e}</h1>
      </header>
      
      <div class="simulation-options">
        ${n}

        <!-- Result Card -->
        <div id="result-card" class="option-card" style="display: none;">
           <div class="option-group" style="width: 100%; align-items: stretch; text-align: left;">
             <h3>  </h3>
             <p style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">AI      .</p>
             <textarea id="prompt-output" class="prompt-textarea result-textarea" readonly></textarea>
           </div>
           <div class="result-actions">
             <button id="copy-btn" class="secondary-btn" style="width: 100%;">
                  
             </button>
             ${o==="image-prompt"?'<button id="test-image-btn" class="cta-btn" style="width: 100%; margin-top: 0.5rem;">     ()</button>':""}
           </div>
           <div id="test-image-result" style="margin-top: 1rem; display: none;"></div>
        </div>
      </div>
      ${ue}
    </main>
  `,(u=document.getElementById("back-btn"))==null||u.addEventListener("click",ne),(c=document.getElementById("change-api-key-btn"))==null||c.addEventListener("click",z);const i=document.getElementById("generate-prompt-btn"),l=document.getElementById("copy-btn"),a=document.getElementById("test-image-btn");if(o==="image-prompt"&&document.querySelectorAll(".selection-group").forEach(p=>{p.addEventListener("click",f=>{const y=f.target.closest(".chip-btn");y&&(p.querySelectorAll(".chip-btn").forEach(g=>g.classList.remove("active")),y.classList.add("active"))})}),o==="video-prompt"){const d=document.getElementById("movement-chips"),p=document.getElementById("custom-movement-input-wrapper");d==null||d.addEventListener("click",y=>{var m;const g=y.target.closest(".chip-btn");g&&(g.classList.toggle("active"),g.id==="custom-movement-btn"&&p&&(p.style.display=g.classList.contains("active")?"block":"none",g.classList.contains("active")&&((m=document.getElementById("custom-movement-input"))==null||m.focus())))});const f=document.getElementById("camera-options");f==null||f.addEventListener("change",y=>{var m;f.querySelectorAll(".radio-item").forEach(h=>h.classList.remove("selected"));const g=y.target;g.checked&&((m=g.closest(".radio-item"))==null||m.classList.add("selected"))})}i.addEventListener("click",async()=>{var g;let d="",p="";if(o==="image-prompt"){const m=w=>{const x=document.querySelector(`.selection-group[data-group="${w}"] .chip-btn.active`);return x?x.dataset.value:""},h=m("gender")||"Female",E=m("age")||"20s",C=m("face-style")||"Natural",v=m("lighting")||"Soft studio lighting",T=m("expression")||"Natural neutral expression",I=document.getElementById("image-additional-prompt").value.trim();p=`
You are an expert prompt engineer for Midjourney.
Your task is to fill in the following template based on the user's choices.
Do NOT change the style keywords at the end.
Do NOT add any conversational text. Output ONLY the final prompt.

Template:
"a realistic portrait of a Korean ${h} character in ${E}, ${C} face, ${T}, [Insert Additional Prompt Here if provided], [Insert Lighting Here], realistic photography, realistic photography style, not illustration, no airbrushing, no smoothing, no beauty retouch, facial proportions and head shape consistent with the reference image, hair and clothing inspired by the reference, keeping a similar orientation, background style consistent with the reference photo, environment unmodified, facial features naturally reinterpreted with realistic detail, Korean aesthetic beauty, realistic lip texture, delicate features, even facial lighting, remove strong sunlight patches on the face, no harsh highlights --style raw --stylize 100"
`,d=`
        User Choices:
        - Gender: ${h}
        - Age: ${E}
        - Face Style: ${C}
        - Expression: ${T}
        - Lighting: ${v}
        - Additional Details: ${I}
        `}else{const m=document.querySelectorAll("#movement-chips .chip-btn.active"),h=[];m.forEach(T=>{const I=T.dataset.value;if(I==="custom"){const w=document.getElementById("custom-movement-input").value.trim();w&&h.push(w)}else I&&h.push(I)});const E=document.querySelector('input[name="camera-move"]:checked'),C=E?E.value:"none",v=document.getElementById("video-additional-prompt").value;if(h.length===0&&!v.trim()){alert("      .");return}d=`
          [Video Generation Request (Image-to-Video)]
          Since this is image-to-video, visual details are already provided by the image.
          We only need to describe movement.

          1. Model Movement: ${h.join(", ")||"No specific movement, just natural presence."}
          2. Camera Movement: ${C}
          3. Additional Context: ${v}
        `,p=`
        You are a helper for creating Image-to-Video prompts.
        The user provides a source image, so you MUST NOT describe the character's appearance, clothes, lighting, or background.
        
        Your task is to write ONE simple English sentence describing ONLY the physical motion and camera movement.
        
        Rules:
        1. Keep it extremely simple.
        2. NO adjectives about beauty or style.
        3. Format: [Subject] [Action] + [Camera Move].
        
        Examples:
        - "The model smiles gently as the camera zooms in."
        - "The woman turns her head to the left."
        - "The hair blows in the wind with a panning camera."
        `}const f=document.getElementById("result-card"),y=document.getElementById("prompt-output");i.disabled=!0,i.textContent=" ...",i.classList.add("loading");try{const h=(g=(await O.models.generateContent({model:"gemini-2.5-flash",contents:d,config:{systemInstruction:p}})).text)==null?void 0:g.trim();h&&(y.value=h,f.style.display="flex",f.scrollIntoView({behavior:"smooth"}))}catch(m){console.error("Prompt generation failed:",m),alert("  .  .")}finally{i.disabled=!1,i.textContent=" ",i.classList.remove("loading")}}),l==null||l.addEventListener("click",()=>{document.getElementById("prompt-output").select(),document.execCommand("copy");const p=l.innerText;l.innerText="  !",setTimeout(()=>{l.innerText=p},2e3)}),o==="image-prompt"&&a&&a.addEventListener("click",async()=>{var f,y,g,m;const d=document.getElementById("prompt-output").value,p=document.getElementById("test-image-result");if(d){a.textContent="  ...",a.disabled=!0,p.style.display="block",p.innerHTML='<div class="spinner" style="margin: 0 auto;"></div>';try{const h=d.replace(/--\w+\s+[^\s]+/g,"").replace(/--\w+/g,"").trim(),C=(m=(g=(y=(f=(await O.models.generateContent({model:"gemini-2.5-flash-image",contents:[{role:"user",parts:[{text:h}]}],config:{responseModalities:[j.IMAGE]}})).candidates)==null?void 0:f[0])==null?void 0:y.content)==null?void 0:g.parts)==null?void 0:m.find(v=>v.inlineData);if(C!=null&&C.inlineData){const v=C.inlineData.data,I=`data:${C.inlineData.mimeType};base64,${v}`;p.innerHTML=`
                    <div style="margin-top: 1rem;">
                        <img src="${I}" alt="Generated Image" style="width: 100%; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <a href="${I}" download="generated_image.png" class="secondary-btn" style="display: block; margin-top: 0.5rem; text-align: center; text-decoration: none;"> </a>
                        <p style="font-size: 0.8rem; color: #666; margin-top: 0.5rem;">*   Gemini  . Midjourney    .</p>
                    </div>
                `}else throw new Error("No image returned")}catch(h){console.error("Image generation failed",h),alert("  ."),p.style.display="none"}finally{a.textContent="     ()",a.disabled=!1}}})}function G(o){const t=document.getElementById("root");if(!t){console.error("Root element not found");return}const e={lip:"  ",eyebrow:"  ",hair:" ",clothing:" ",background:" "},n=`
    <div class="option-card">
      <div class="option-group">
          <h3></h3>
          <div class="option-choices">
              <button class="option-btn active" data-group="gender" data-value="female"></button>
              <button class="option-btn" data-group="gender" data-value="male"></button>
          </div>
      </div>
      <div class="option-group">
          <h3></h3>
          <div class="option-choices">
              <button class="option-btn" data-group="age" data-value="20s">20</button>
              <button class="option-btn" data-group="age" data-value="30s">30</button>
              <button class="option-btn active" data-group="age" data-value="40s">40</button>
              <button class="option-btn" data-group="age" data-value="50s">50</button>
              <button class="option-btn" data-group="age" data-value="60s">60</button>
              <button class="option-btn" data-group="age" data-value="70s+">70 </button>
          </div>
      </div>
    </div>`,i=`
    <div class="option-card">
      <div class="option-group">
          <h3> </h3>
          <div class="option-choices" style="flex-wrap: wrap; justify-content: center;">
              <button class="option-btn" data-group="face-style" data-value="attractive"> </button>
              <button class="option-btn" data-group="face-style" data-value="natural"></button>
              <button class="option-btn active" data-group="face-style" data-value="unique"></button>
              <button class="option-btn" data-group="face-style" data-value="east-asian"> </button>
              <button class="option-btn" data-group="face-style" data-value="youthful"> </button>
          </div>
      </div>
      <div class="checkbox-wrapper">
          <input type="checkbox" id="new-face-checkbox" class="custom-checkbox">
          <label for="new-face-checkbox">     </label>
      </div>
      <div class="option-group" style="width: 100%;">
        <h3>  ?</h3>
        <div class="select-wrapper">
          <select id="expression-select" class="custom-select">
            <option value="none">  </option>
            <option value="natural"> </option>
            <option value="expressionless"></option>
            <option value="slight_smile"> </option>
            <option value="bright_smile"> </option>
            <option value="serious"> </option>
            <option value="soft_eye_smile"> </option>
            <option value="side_look">  ()</option>
            <option value="relaxed_lips">   </option>
            <option value="focused"> </option>
            <option value="various"> </option>
            <option value="custom">( )</option>
          </select>
        </div>
      </div>
      <div id="expression-custom-prompt-wrapper" class="prompt-wrapper" style="display: none; width: 100%;">
          <textarea id="expression-custom-prompt" class="prompt-textarea" placeholder="   ."></textarea>
      </div>
      <div class="prompt-wrapper">
          <label for="custom-prompt" class="prompt-label">  ()</label>
          <textarea id="custom-prompt" class="prompt-textarea" placeholder="  ,  ,        ."></textarea>
      </div>
    </div>`,l=`
    <div class="option-card">
      <div class="option-group" style="width: 100%;">
        <h3></h3>
        <div class="select-wrapper">
          <select id="hair-style-select" class="custom-select">
            <option value="none">  </option>
            <option value="custom"> ()</option>
            <option value="image"></option>
            <option value="layered_cut"></option>
            <option value="c_curl_perm">C</option>
            <option value="s_curl_perm">S</option>
            <option value="bob_cut"></option>
            <option value="one_length_cut"></option>
            <option value="hush_cut"></option>
            <option value="shag_cut"></option>
            <option value="dandy_cut"></option>
            <option value="two_block_cut"></option>
            <option value="crop_cut"></option>
            <option value="ivy_league_cut"></option>
            <option value="regent_cut"></option>
            <option value="leaf_cut"></option>
            <option value="hippie_perm"></option>
            <option value="lovely_perm"></option>
            <option value="jelly_perm"></option>
            <option value="volume_magic"></option>
            <option value="air_perm"></option>
            <option value="glam_perm"></option>
            <option value="short_cut"></option>
          </select>
        </div>
      </div>
      <div id="hair-custom-prompt-wrapper" class="hair-input-wrapper" style="display: none;">
        <textarea id="hair-custom-prompt" class="prompt-textarea" placeholder="   ."></textarea>
      </div>
      <div id="hair-image-upload-wrapper" class="hair-input-wrapper" style="display: none;">
        <input type="file" id="hair-image-input" accept="image/*" style="display: none;">
        <button id="hair-image-upload-btn" class="action-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
          <span>  </span>
        </button>
        <div id="hair-image-preview-container"></div>
      </div>
    </div>`,a=`
    <div class="option-card">
      <div class="option-group" style="width: 100%;">
        <h3></h3>
        <div class="select-wrapper">
          <select id="clothing-style-select" class="custom-select">
            <option value="none">  </option>
            <option value="custom"> ()</option>
            <option value="image"></option>
            <option value="white_t-shirt"> </option>
            <option value="black_knit"> </option>
            <option value="denim_jacket"></option>
            <option value="blouse"></option>
            <option value="dress"></option>
            <option value="suit"></option>
            <option value="hoodie"></option>
            <option value="leather_jacket"> </option>
            <option value="shirt"></option>
            <option value="trench_coat"> </option>
            <option value="v-neck_sweater">V </option>
            <option value="off-shoulder"></option>
            <option value="cardigan"></option>
            <option value="turtleneck"> </option>
            <option value="sweatshirt"></option>
            <option value="blue_shirt"> </option>
            <option value="pink_dress"> </option>
            <option value="beige_coat"> </option>
            <option value="striped_t-shirt"> </option>
            <option value="plaid_shirt"> </option>
          </select>
        </div>
      </div>
      <div id="clothing-custom-prompt-wrapper" class="hair-input-wrapper" style="display: none;">
        <textarea id="clothing-custom-prompt" class="prompt-textarea" placeholder="   ."></textarea>
      </div>
      <div id="clothing-image-upload-wrapper" class="hair-input-wrapper" style="display: none;">
        <input type="file" id="clothing-image-input" accept="image/*" style="display: none;">
        <button id="clothing-image-upload-btn" class="action-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
          <span>  </span>
        </button>
        <div id="clothing-image-preview-container"></div>
      </div>
    </div>`,u=`
    <div class="option-card">
      <div class="option-group" style="width: 100%;">
        <h3></h3>
        <div class="select-wrapper">
          <select id="background-style-select" class="custom-select">
            <option value="none">  </option>
            <option value="custom"> ()</option>
            <option value="image"></option>
            <option value="white_background"> </option>
            <option value="gray_background"> </option>
            <option value="studio"></option>
            <option value="nature_landscape"> </option>
            <option value="city_nightscape"> </option>
            <option value="cafe"></option>
            <option value="office"></option>
            <option value="library"></option>
            <option value="park"></option>
            <option value="beach"></option>
            <option value="forest"> </option>
            <option value="sunset_sky">  </option>
            <option value="street"></option>
            <option value="party_venue"></option>
            <option value="flower_garden"></option>
            <option value="riverside"></option>
            <option value="brick_wall"> </option>
            <option value="modern_interior"> </option>
            <option value="traditional_house"> </option>
            <option value="cloudy_weather"> </option>
          </select>
        </div>
      </div>
      <div id="background-custom-prompt-wrapper" class="hair-input-wrapper" style="display: none;">
        <textarea id="background-custom-prompt" class="prompt-textarea" placeholder="   ."></textarea>
      </div>
      <div id="background-image-upload-wrapper" class="hair-input-wrapper" style="display: none;">
        <input type="file" id="background-image-input" accept="image/*" style="display: none;">
        <button id="background-image-upload-btn" class="action-btn">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
          <span>  </span>
        </button>
        <div id="background-image-preview-container"></div>
      </div>
    </div>`,c=`
    <div class="option-card">
      <div class="option-group" style="width: 100%; align-items: stretch;">
        <h3>  ()</h3>
        <textarea id="free-prompt" class="prompt-textarea" placeholder="    AI  . (: '   ', '  ')"></textarea>
      </div>
    </div>`;t.innerHTML=`
    <main class="app-container" role="main" data-simulation-type="${o}">
      <header class="simulation-header">
        <button id="back-btn" class="back-btn" aria-label="">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
        </button>
        <h1>${e[o]}</h1>
      </header>
      
      <div class="panels-container">
        <!-- Before Panel -->
        <div class="image-panel" id="before-panel">
          <div class="panel-header">
            <h2>Before</h2>
            <div class="panel-actions">
              <input type="file" id="upload-input" accept="image/*" style="display: none;">
              <button id="upload-btn" class="action-btn" aria-label=" ">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/></svg>
                <span></span>
              </button>
              <button id="delete-btn" class="action-btn" aria-label=" " style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5z"/></svg>
                <span></span>
              </button>
            </div>
          </div>
          <div id="image-container" class="image-container">
            ${D?`<img src="${D}" alt=" " class="image-preview">`:`
            <div class="image-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#cccccc"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
              <p>  </p>
            </div>`}
          </div>
        </div>
        
        <!-- After Panel -->
        <div class="image-panel" id="after-panel">
           <div class="panel-header">
            <h2>After</h2>
            <div class="panel-actions">
              <a id="download-btn" class="action-btn" aria-label=" " style="pointer-events: none; opacity: 0.5;" download="simulation_result.png">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                <span></span>
              </a>
            </div>
          </div>
          <div id="after-image-container" class="image-container">
            <div class="image-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#cccccc"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
              <p>AI  </p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Options -->
      <div class="simulation-options">
        ${o==="lip"||o==="eyebrow"?n:""}
        ${o==="lip"||o==="eyebrow"?i:""}
        ${o==="hair"?l:""}
        ${o==="clothing"?a:""}
        ${o==="background"?u:""}
        ${c}
      </div>

      <button id="generate-btn" class="cta-btn" disabled>AI  </button>
      ${ue}
    </main>
  `,Ki(),re()}function Yi(o){var h,E,C;const t=[],e=document.getElementById("new-face-checkbox"),n="    AI   .           .";let i="",l=[],a="";switch(o){case"lip":i=" '    '  .      .",a=" ( )",l=["","(, ,  )","",""];break;case"eyebrow":i=" '    '  .      .",a=" ( )",l=["","(, ,  )","",""];break;case"hair":i=" ''  .",a="",l=[" ","","","",""];break;case"clothing":i=" ''  .",a="",l=[" ","","","",""];break;case"background":i=" ''  .",a="",l=[" (, ,  )"];break}const u=l.map((v,T)=>`${T+1}. ${v}`).join(" ");t.push(`${n} ${i} [ ]  '   ' 100% ,      .  '  '      . [   ] ${u}. [  ]  '${a}'   .`),e!=null&&e.checked?t.push(" :      ,      .  , , ,       ."):o!=="background"&&t.push(" :       .");const c={};if(!l.some(v=>v.includes(""))){const v=((h=document.querySelector('.option-btn[data-group="gender"].active'))==null?void 0:h.dataset.value)||"female",T=((E=document.querySelector('.option-btn[data-group="age"].active'))==null?void 0:E.dataset.value)||"20s";c[" "]=`${T} ${v}`;const I=((C=document.querySelector('.option-btn[data-group="face-style"].active'))==null?void 0:C.dataset.value)||"attractive",w={attractive:" ",natural:"",unique:"","east-asian":" ",youthful:" "};c[" "]=`${w[I]}`;const x=document.getElementById("expression-select");if(x){const S=x.value;if(S==="custom"){const N=document.getElementById("expression-custom-prompt").value;N&&(c.=N)}else S!=="none"?c.=x.options[x.selectedIndex].text:e!=null&&e.checked||(c.="    ")}const M=document.getElementById("custom-prompt").value;M&&(c["  "]=M)}const d=document.getElementById("hair-style-select");if(d&&o==="hair"){const v=d.value;if(v==="custom"){const T=document.getElementById("hair-custom-prompt").value;T&&(c[" "]=T)}else v!=="none"&&v!=="image"&&(c[" "]=d.options[d.selectedIndex].text)}const p=document.getElementById("clothing-style-select");if(p&&o==="clothing"){const v=p.value;if(v==="custom"){const T=document.getElementById("clothing-custom-prompt").value;T&&(c[" "]=T)}else v!=="none"&&v!=="image"&&(c[" "]=p.options[p.selectedIndex].text)}const f=document.getElementById("background-style-select");if(f&&o==="background"){const v=f.value;if(v==="custom"){const T=document.getElementById("background-custom-prompt").value;T&&(c[" "]=T)}else v!=="none"&&v!=="image"&&(c[" "]=f.options[f.selectedIndex].text)}const y=document.getElementById("free-prompt").value;y&&(c[" "]=y);const g=Object.entries(c).map(([v,T])=>`${v}: ${T}`).join(". ");g&&t.push(`[ ] ${g}`);let m="        . ";return m+="   : [   ] ,   .        .",t.push(m),t.join(" ")}function Ki(){var p,f,y,g;(p=document.getElementById("back-btn"))==null||p.addEventListener("click",ne),(f=document.getElementById("change-api-key-btn"))==null||f.addEventListener("click",z);const o=document.getElementById("upload-input"),t=document.getElementById("image-container"),e=document.getElementById("delete-btn");(y=document.getElementById("upload-btn"))==null||y.addEventListener("click",()=>{o==null||o.click()}),t==null||t.addEventListener("click",m=>{m.target.closest(".image-placeholder")&&(o==null||o.click())}),o==null||o.addEventListener("change",m=>{var E;const h=(E=m.target.files)==null?void 0:E[0];if(h&&t){const C=new FileReader;C.onload=v=>{var T;D=(T=v.target)==null?void 0:T.result,t.innerHTML=`<img src="${D}" alt=" " class="image-preview">`,e==null||e.style.setProperty("display","inline-flex"),re()},C.readAsDataURL(h)}}),e==null||e.addEventListener("click",()=>{D=null;const m=document.getElementById("after-image-container"),h=document.getElementById("download-btn");t&&(t.innerHTML=`
        <div class="image-placeholder">
          <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#cccccc"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
          <p>  </p>
        </div>
      `),m&&(m.innerHTML=`
            <div class="image-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#cccccc"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
              <p>AI  </p>
            </div>
        `),h&&(h.style.pointerEvents="none",h.style.opacity="0.5",h.href="#"),o.value="",e==null||e.style.setProperty("display","none"),re()}),document.querySelectorAll(".option-btn").forEach(m=>{m.addEventListener("click",h=>{const E=h.currentTarget,C=E.dataset.group;C&&(document.querySelectorAll(`.option-btn[data-group="${C}"]`).forEach(v=>{v.classList.remove("active")}),E.classList.add("active"))})});const n=document.getElementById("expression-select"),i=document.getElementById("expression-custom-prompt-wrapper");n==null||n.addEventListener("change",()=>{i&&(i.style.display=n.value==="custom"?"block":"none")});const l=(m,h,E,C,v)=>{const T=document.getElementById(m),I=document.getElementById(h),w=document.getElementById(E);!T||!I||!w||(T.addEventListener("click",()=>I.click()),I.addEventListener("change",x=>{var S;const M=(S=x.target.files)==null?void 0:S[0];if(M){const N=new FileReader;N.onload=L=>{var B,q;w.innerHTML=`
                      <div class="image-preview-item">
                          <img src="${(B=L.target)==null?void 0:B.result}" alt="${C}">
                          <button class="preview-delete-btn" aria-label="${v}">
                              <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
                          </button>
                      </div>`,(q=w.querySelector(".preview-delete-btn"))==null||q.addEventListener("click",()=>{w.innerHTML="",I.value=""})},N.readAsDataURL(M)}}))},a=document.getElementById("hair-style-select");if(a){const m=document.getElementById("hair-custom-prompt-wrapper"),h=document.getElementById("hair-image-upload-wrapper");a.addEventListener("change",()=>{!m||!h||(m.style.display=a.value==="custom"?"block":"none",h.style.display=a.value==="image"?"flex":"none")}),l("hair-image-upload-btn","hair-image-input","hair-image-preview-container"," ","  ")}const u=document.getElementById("clothing-style-select");if(u){const m=document.getElementById("clothing-custom-prompt-wrapper"),h=document.getElementById("clothing-image-upload-wrapper");u.addEventListener("change",()=>{!m||!h||(m.style.display=u.value==="custom"?"block":"none",h.style.display=u.value==="image"?"flex":"none")}),l("clothing-image-upload-btn","clothing-image-input","clothing-image-preview-container"," ","  ")}const c=document.getElementById("background-style-select");if(c){const m=document.getElementById("background-custom-prompt-wrapper"),h=document.getElementById("background-image-upload-wrapper");c.addEventListener("change",()=>{!m||!h||(m.style.display=c.value==="custom"?"block":"none",h.style.display=c.value==="image"?"flex":"none")}),l("background-image-upload-btn","background-image-input","background-image-preview-container"," ","  ")}const d=document.getElementById("after-image-container");d==null||d.addEventListener("click",()=>{const m=d.querySelector("img.image-preview"),h=document.getElementById("download-btn");if(m&&h.href&&!h.href.startsWith(window.location.href)){const E=d.querySelector(".download-overlay");if(E){E.remove();return}const C=document.createElement("div");C.className="download-overlay",C.innerHTML=`
            <a href="${h.href}" download="simulation_result.png" class="download-overlay-btn" aria-label=" ">
                <svg xmlns="http://www.w3.org/2000/svg" height="32px" viewBox="0 0 24 24" width="32px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                <span></span>
            </a>
        `,C.addEventListener("click",v=>{v.target===C&&C.remove()}),d.appendChild(C)}}),(g=document.getElementById("generate-btn"))==null||g.addEventListener("click",Ji)}async function Ji(){var a,u,c,d;const o=document.getElementById("generate-btn"),t=document.getElementById("after-image-container"),e=document.getElementById("download-btn"),n=document.querySelector(".app-container[data-simulation-type]");if(!D||!o||!t||!e||!n)return;const i=t.querySelector(".download-overlay");i&&i.remove();const l=n.dataset.simulationType;o.disabled=!0,o.textContent="AI  ...",o.classList.add("loading"),t.innerHTML='<div class="spinner"></div>',e.style.pointerEvents="none",e.style.opacity="0.5";try{const p=Yi(l);console.log("Final Prompt:",p);const f=D.match(/^data:(image\/.*?);base64,(.*)$/);if(!f)throw new Error("Invalid image format");const[,y,g]=f,m={inlineData:{mimeType:y,data:g}},h={text:p},C=(d=(c=(u=(a=(await O.models.generateContent({model:"gemini-2.5-flash-image",contents:[{role:"user",parts:[m,h]}],config:{responseModalities:[j.IMAGE]}})).candidates)==null?void 0:a[0])==null?void 0:u.content)==null?void 0:c.parts)==null?void 0:d.find(w=>w.inlineData);if(!(C!=null&&C.inlineData))throw new Error("AI did not return an image.");const v=C.inlineData.data,I=`data:${C.inlineData.mimeType};base64,${v}`;t.innerHTML=`<img src="${I}" alt="AI  " class="image-preview">`,e.href=I,e.style.pointerEvents="auto",e.style.opacity="1",o.textContent=" ()"}catch(p){console.error("Image generation failed:",p),alert("  . API   ,       ."),t.innerHTML=`
      <div class="image-placeholder">
        <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#cccccc"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/></svg>
        <p>AI  </p>
      </div>`,o.textContent="AI  "}finally{o.disabled=!1,o.classList.remove("loading")}}function re(){const o=document.getElementById("generate-btn");o&&(o.disabled=!D)}function Wi(){localStorage.setItem(H,zi);const o=localStorage.getItem(H);if(o)try{O=new gt({apiKey:o}),ne()}catch(t){console.error("Failed to initialize GoogleGenAI with stored key:",t),localStorage.removeItem(H),z()}else z()}Wi();
